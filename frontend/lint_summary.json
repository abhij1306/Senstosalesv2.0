(node:27348) ESLintIgnoreWarning: The ".eslintignore" file is no longer supported. Switch to using the "ignores" property in "eslint.config.js": https://eslint.org/docs/latest/use/configure/migration-guide#ignoring-files
(Use `node --trace-warnings ...` to show where the warning was created)
[{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\dc\\[...id]\\page.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[500,506],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":8},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":191,"column":17,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":191,"endColumn":65},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":530,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":530,"endColumn":75}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useState, Suspense, useCallback } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport {\n  AlertCircle,\n  FileDown,\n  FileText,\n  Plus,\n  Trash2,\n  Truck,\n  Edit2,\n  X,\n  Save,\n} from \"lucide-react\";\nimport { api, API_BASE_URL } from \"@/lib/api\";\nimport { formatDate } from \"@/lib/utils\";\nimport { normalizeId, poRoute, invoiceRoute, createInvoiceRoute } from \"@/lib/routes\";\nimport { DCItemRow as DCItemRowType } from \"@/types\";\nimport {\n  Badge,\n  H3,\n  Body,\n  SmallText,\n  Label,\n  Accounting,\n  Button,\n  Input,\n  Card,\n} from \"@/components/design-system/organisms\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport {\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n} from \"@/components/design-system/molecules/Tabs\";\nimport { type Column } from \"@/components/design-system/organisms/DataTable\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport dynamic from \"next/dynamic\";\nimport { DetailSkeleton } from \"@/components/design-system/molecules/skeletons/DetailSkeleton\";\n\nconst DataTable = dynamic(\n  () => import(\"@/components/design-system/organisms/DataTable\").then((mod) => mod.DataTable),\n  {\n    loading: () => <div className=\"h-64 w-full bg-[var(--color-sys-bg-tertiary)]/50 rounded-xl animate-pulse\" />,\n    ssr: false,\n  }\n);\n\nconst DocumentJourney = dynamic(\n  () =>\n    import(\"@/components/design-system/molecules/DocumentJourney\").then(\n      (mod) => mod.DocumentJourney\n    ),\n  {\n    loading: () => <div className=\"h-6 w-48 bg-[var(--color-sys-bg-tertiary)] rounded-full animate-pulse\" />,\n    ssr: false,\n  }\n);\n\nfunction DCDetailContent() {\n  const router = useRouter();\n  const params = useParams();\n  const dcId = normalizeId(params?.id as string | string[] || \"\");\n\n  const [loading, setLoading] = useState(true);\n  const [editMode, setEditMode] = useState(false);\n  const [hasInvoice, setHasInvoice] = useState(false);\n  const [invoiceNumber, setInvoiceNumber] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [items, setItems] = useState<DCItemRowType[]>([]);\n  const [notes, setNotes] = useState<string[]>([]);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n\n  const [formData, setFormData] = useState({\n    dc_number: \"\",\n    dc_date: \"\",\n    po_number: \"\",\n    supplier_phone: \"0755 ΓÇô 4247748\",\n    supplier_gstin: \"23AACFS6810L1Z7\",\n    consignee_name: \"The Sr. Manager (CRX)\",\n    consignee_address: \"M/S Bharat Heavy Eletrical Ltd. Bhopal\",\n    department_no: \"\",\n    eway_bill_number: \"\",\n    status: \"\",\n    statusVariant: undefined as any,\n  });\n  const [activeTab, setActiveTab] = useState(\"basic\");\n\n  useEffect(() => {\n    if (!dcId) return;\n    let isMounted = true;\n    const loadDCData = async () => {\n      try {\n        const [data, invoiceData] = await Promise.all([\n          api.getDCDetail(dcId),\n          api.checkDCHasInvoice(dcId),\n        ]);\n\n        if (!isMounted) return;\n\n        if (data.header) {\n          setFormData({\n            dc_number: data.header.dc_number || \"\",\n            dc_date: data.header.dc_date || \"\",\n            po_number: data.header.po_number?.toString() || \"\",\n            supplier_phone: data.header.supplier_phone || \"0755 ΓÇô 4247748\",\n            supplier_gstin: data.header.supplier_gstin || \"23AACFS6810L1Z7\",\n            consignee_name: data.header.consignee_name || \"The Sr. Manager (CRX)\",\n            consignee_address:\n              data.header.consignee_address || \"M/S Bharat Heavy Eletrical Ltd. Bhopal\",\n            department_no: data.header.department_no?.toString() || \"\",\n            eway_bill_number: data.header.eway_bill_no || \"\",\n            status: data.header.status || \"Pending\",\n            statusVariant: undefined as any,\n          });\n          if (data.items) {\n            setItems(\n              data.items.map((item: any, idx: number) => ({\n                id: `item-${idx}`,\n                lot_no: item.lot_no?.toString() || (idx + 1).toString(),\n                material_code: item.material_code || \"\",\n                description: item.material_description || item.description || \"\",\n                ordered_quantity: item.lot_ordered_qty || item.ordered_qty || 0,\n                remaining_post_dc: item.remaining_post_dc || 0,\n                dispatch_quantity: item.dispatched_quantity || item.dispatch_qty || item.dispatch_quantity || 0,\n                received_quantity: item.received_quantity || 0,\n                po_item_id: item.po_item_id,\n              }))\n            );\n          }\n          if (data.header.remarks) setNotes(data.header.remarks.split(\"\\n\\n\"));\n        }\n\n        if (invoiceData?.has_invoice) {\n          setHasInvoice(true);\n          setInvoiceNumber(invoiceData.invoice_number || null);\n        }\n      } catch (err: any) {\n        if (isMounted) setError(err.message || \"Failed to load DC\");\n      } finally {\n        if (isMounted) setLoading(false);\n      }\n    };\n    loadDCData();\n\n    return () => {\n      isMounted = false;\n    };\n  }, [dcId]);\n\n  const handleSave = useCallback(async () => {\n    setLoading(true);\n    try {\n      await api.updateDC(dcId!, formData, items);\n      setEditMode(false);\n    } catch (err: any) {\n      setError(err.message || \"Failed to save\");\n    } finally {\n      setLoading(false);\n    }\n  }, [dcId, formData, items]);\n\n  const handleDelete = async () => {\n    setLoading(true);\n    try {\n      await api.deleteDC(dcId!);\n      router.push(\"/dc\");\n    } catch (err: any) {\n      setError(err.message || \"Failed to delete DC\");\n      setShowDeleteConfirm(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const itemColumns: Column<any>[] = [\n    {\n      key: \"material_code\",\n      label: \"Code\",\n      width: \"10%\",\n      render: (v) => <Accounting className=\"font-mono\">{v}</Accounting>,\n    },\n    {\n      key: \"description\",\n      label: \"Description\",\n      width: \"35%\",\n      render: (_v, row) => (\n        <div className=\"space-y-0.5\">\n          <Body className=\"text-[var(--color-sys-text-primary)]\">{row.description}</Body>\n          {row.drg_no && (\n            <SmallText className=\"text-sys-brand\">\n              DRG: {row.drg_no}\n            </SmallText>\n          )}\n        </div>\n      ),\n    },\n    {\n      key: \"ordered_quantity\",\n      label: \"Ord\",\n      align: \"right\",\n      width: \"8%\",\n      render: (v) => <Accounting className=\"text-right\">{v}</Accounting>,\n    },\n    {\n      key: \"dispatch_quantity\",\n      label: \"Dlv\",\n      align: \"right\",\n      width: \"8%\",\n      render: (v, row, idx) => {\n        if (editMode && idx !== undefined) {\n          return (\n            <Input\n              type=\"number\"\n              value={v || \"\"}\n              onChange={(e) => {\n                const newItems = [...items];\n                newItems[idx].dispatch_quantity = parseFloat(e.target.value) || 0;\n                setItems(newItems);\n              }}\n              className=\"text-right max-w-[80px] ml-auto h-8 px-2 font-mono text-sys-brand border-sys-error-subtle focus:border-blue-500\"\n            />\n          );\n        }\n        return (\n          <Accounting className=\"text-sys-brand text-right block font-mono\">\n            {v}\n          </Accounting>\n        );\n      },\n    },\n    {\n      key: \"remaining_post_dc\",\n      label: \"Bal\",\n      align: \"right\",\n      width: \"8%\",\n      render: (v) => <Accounting className=\"text-right block font-mono\">{v}</Accounting>,\n    },\n    {\n      key: \"received_quantity\",\n      label: \"Rec\",\n      align: \"right\",\n      width: \"8%\",\n      render: (v) => (\n        <Accounting className=\"text-sys-success text-right block font-mono\">\n          {v}\n        </Accounting>\n      ),\n    },\n  ];\n\n  const topActions = (\n    <div className=\"flex gap-3\">\n      {!editMode ? (\n        <>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            asChild\n            className=\"text-emerald-700 border-emerald-200 bg-emerald-50 hover:bg-emerald-100 hover:text-emerald-800\"\n          >\n            <a href={`${API_BASE_URL}/api/dc/${dcId}/download`} target=\"_blank\" rel=\"noreferrer\">\n              <FileDown size={16} className=\"mr-2\" />\n              Excel\n            </a>\n          </Button>\n          {hasInvoice && (\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={() => router.push(invoiceRoute(invoiceNumber!))}\n            >\n              <FileText size={16} />\n              View Invoice\n            </Button>\n          )}\n          {!hasInvoice && (\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={() => router.push(createInvoiceRoute(dcId))}\n            >\n              <Plus size={16} />\n              Create Invoice\n            </Button>\n          )}\n          <Button variant=\"default\" size=\"sm\" onClick={() => setEditMode(true)}>\n            <Edit2 size={16} />\n            Edit\n          </Button>\n          {!hasInvoice && (\n            <Button variant=\"destructive\" size=\"sm\" onClick={() => setShowDeleteConfirm(true)}>\n              <Trash2 size={16} />\n              Delete\n            </Button>\n          )}\n        </>\n      ) : (\n        <>\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => setEditMode(false)}>\n            <X size={16} />\n            Cancel\n          </Button>\n          <Button variant=\"default\" size=\"sm\" onClick={handleSave}>\n            <Save size={16} />\n            Save\n          </Button>\n        </>\n      )}\n    </div>\n  );\n\n  if (loading || !formData.dc_number) {\n    return <DetailSkeleton />;\n  }\n\n  return (\n    <DocumentTemplate\n      title={`DC #${formData.dc_number}`}\n      description={`${formData.consignee_name} ΓÇó ${formatDate(formData.dc_date)}`}\n      actions={topActions}\n      onBack={() => router.back()}\n      layoutId={`dc-title-${formData.dc_number}`}\n      icon={<Truck size={20} className=\"text-emerald-700\" />}\n      iconLayoutId={`dc-icon-${formData.dc_number}`}\n      status={formData.status}\n      statusVariant={formData.statusVariant}\n    >\n      <div className=\"space-y-6\">\n        <DocumentJourney currentStage=\"DC\" className=\"mb-2\" />\n\n        {error && (\n          <Card className=\"p-4 bg-sys-error-subtle border-sys-error-subtle\">\n            <div className=\"flex items-center gap-2 text-sys-error\">\n              <AlertCircle size={16} />\n              <SmallText className=\"font-semibold text-sys-error\">{error}</SmallText>\n            </div>\n          </Card>\n        )}\n\n        {/* Delete Confirmation Dialog */}\n        {showDeleteConfirm && (\n          <Card className=\"p-6 bg-red-50 border-sys-error-subtle\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-sys-error-subtle rounded-full\">\n                  <Trash2 size={20} className=\"text-sys-error\" />\n                </div>\n                <div>\n                  <H3 className=\"text-h3 text-slate-950\">\n                    Delete Delivery Challan?\n                  </H3>\n                  <SmallText className=\"text-slate-500 mt-1 block\">\n                    This action cannot be undone. The DC and all its items will be permanently\n                    deleted.\n                  </SmallText>\n                </div>\n              </div>\n              <div className=\"flex gap-3 justify-end\">\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setShowDeleteConfirm(false)}>\n                  Cancel\n                </Button>\n                <Button variant=\"destructive\" size=\"sm\" onClick={handleDelete}>\n                  <Trash2 size={16} />\n                  Delete DC\n                </Button>\n              </div>\n            </div>\n          </Card>\n        )}\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"mb-4 bg-transparent p-0 border-b border-[var(--color-sys-text-tertiary)]/10\">\n            <TabsTrigger value=\"basic\">Basic Info</TabsTrigger>\n            <TabsTrigger value=\"supplier\">Supplier</TabsTrigger>\n            <TabsTrigger value=\"consignee\">Consignee</TabsTrigger>\n          </TabsList>\n\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={activeTab}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.15 }}\n            >\n              <Card className=\"p-6 mt-0 border-none shadow-sm bg-[var(--color-sys-bg-surface)]/50 backdrop-blur-sm relative top-[-1px]\">\n                <TabsContent value=\"basic\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>DC Number</Label>\n                      <Input value={formData.dc_number} readOnly className=\"bg-[var(--color-sys-bg-tertiary)]/50\" />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>DC Date</Label>\n                      <Input\n                        type=\"date\"\n                        value={formData.dc_date}\n                        onChange={(e) => setFormData({ ...formData, dc_date: e.target.value })}\n                        readOnly={!editMode}\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>PO Number</Label>\n                      <Input\n                        value={formData.po_number}\n                        readOnly\n                        className=\"bg-[var(--color-sys-bg-tertiary)]/50 cursor-pointer\"\n                        onClick={() => router.push(poRoute(formData.po_number))}\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Department No</Label>\n                      <Input\n                        value={formData.department_no}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            department_no: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>E-Way Bill Number</Label>\n                      <Input\n                        value={formData.eway_bill_number}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            eway_bill_number: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"supplier\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>Supplier Phone</Label>\n                      <Input\n                        value={formData.supplier_phone}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            supplier_phone: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Supplier GSTIN</Label>\n                      <Input\n                        value={formData.supplier_gstin}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            supplier_gstin: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"consignee\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>Consignee Name</Label>\n                      <Input\n                        value={formData.consignee_name}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            consignee_name: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Consignee Address</Label>\n                      <Input\n                        value={formData.consignee_address}\n                        onChange={(e) =>\n                          setFormData({\n                            ...formData,\n                            consignee_address: e.target.value,\n                          })\n                        }\n                        readOnly={!editMode}\n                        className=\"min-h-[60px]\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n              </Card>\n            </motion.div>\n          </AnimatePresence>\n        </Tabs>\n\n        {/* Items Table */}\n        <div className=\"space-y-2\">\n          <H3 className=\"px-1 text-sys-secondary uppercase\">\n            Dispatched Items ({items.length})\n          </H3>\n          <DataTable columns={itemColumns} data={items} keyField=\"id\" density=\"compact\" />\n        </div>\n\n        {/* Notes */}\n        {notes.length > 0 && (\n          <Card className=\"p-6 border-none shadow-sm bg-[var(--color-sys-bg-secondary)]/30\">\n            <H3 className=\"mb-4 text-sys-secondary uppercase\">\n              Notes\n            </H3>\n            <div className=\"space-y-2\">\n              {notes.map((note, idx) => (\n                <div\n                  key={`note-${idx}`}\n                  className=\"p-3 bg-[var(--color-sys-bg-surface)]/50 rounded-lg border border-[var(--color-sys-bg-tertiary)] italic\"\n                >\n                  <Body className=\"text-[var(--color-sys-text-secondary)]\">{note}</Body>\n                </div>\n              ))}\n            </div>\n          </Card>\n        )}\n      </div>\n    </DocumentTemplate>\n  );\n}\n\nexport default function DCDetailPage() {\n  return (\n    <Suspense fallback={<DetailSkeleton />}>\n      <DCDetailContent />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\dc\\create\\page.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":107,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":107,"endColumn":20,"suggestions":[{"fix":{"range":[3962,3981],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":163,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":163,"endColumn":20,"suggestions":[{"fix":{"range":[5874,5916],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":489,"column":40,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":489,"endColumn":88}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useState, Suspense } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { Save, Search, AlertCircle, Loader2, Plus, Trash2, Truck, Calendar } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { cn } from \"@/lib/utils\";\nimport { DCItemRow, POHeader } from \"@/types\";\nimport {\n  H3,\n  Label,\n  SmallText,\n  Body,\n  Accounting,\n} from \"@/components/design-system/organisms\";\nimport { DocumentJourney } from \"@/components/design-system/molecules/DocumentJourney\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport { Button } from \"@/components/design-system/organisms\";\nimport { Badge } from \"@/components/design-system/organisms\";\nimport { Input } from \"@/components/design-system/organisms\";\nimport { Card } from \"@/components/design-system/organisms\";\n\n\nfunction CreateDCPageContent() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const initialPoNumber = searchParams ? searchParams.get(\"po\") : \"\";\n\n  const [poNumber, setPONumber] = useState(initialPoNumber || \"\");\n  const [items, setItems] = useState<DCItemRow[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [poData, setPOData] = useState<POHeader | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [notes, setNotes] = useState<string[]>([]);\n  const [isChecking, setIsChecking] = useState(false);\n  const [isDuplicate, setIsDuplicate] = useState(false);\n  const [conflictType, setConflictType] = useState<string | null>(null);\n  const [debounceTimer, setDebounceTimer] = useState<NodeJS.Timeout | null>(null);\n\n  const [formData, setFormData] = useState({\n    dc_number: \"\",\n    dc_date: new Date().toISOString().split(\"T\")[0],\n    supplier_phone: \"0755 ΓÇô 4247748\",\n    supplier_gstin: \"23AACFS6810L1Z7\",\n    consignee_name: \"\",\n    consignee_address: \"\",\n  });\n\n  useEffect(() => {\n    if (initialPoNumber) {\n      loadInitialData(initialPoNumber);\n    }\n  }, [initialPoNumber]);\n\n  const loadInitialData = async (po: string) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const [lots, pod] = await Promise.all([\n        api.getReconciliationLots(parseInt(po)),\n        api.getPODetail(parseInt(po)),\n      ]);\n\n      // Process Lots\n      const lotsData = Array.isArray(lots) ? lots : (lots as any)?.lots || [];\n      const mappedItems: DCItemRow[] = lotsData.map((lot: any) => ({\n        id: `${lot.po_item_id}-${lot.lot_no}`,\n        lot_no: lot.lot_no?.toString() || \"\",\n        description: lot.material_description || \"\",\n        drg_no: lot.drg_no || \"\",\n        ordered_quantity: lot.ordered_qty || 0,\n        remaining_post_dc: lot.remaining_qty || 0,\n        dispatch_quantity: 0,\n        po_item_id: lot.po_item_id,\n      }));\n      setItems(mappedItems);\n      if (mappedItems.length === 0) setError(\"No items available for dispatch\");\n\n      // Process PO Data\n      if (pod?.header) {\n        setPOData(pod.header);\n        setFormData((prev) => ({\n          ...prev,\n          consignee_name: (pod.header as any)?.consignee_name || \"\",\n          consignee_address: (pod.header as any)?.consignee_address || \"\",\n          supplier_phone: pod.header?.supplier_phone || \"0755 ΓÇô 4247748\",\n          supplier_gstin: pod.header?.supplier_gstin || \"23AACFS6810L1Z7\",\n        }));\n      }\n    } catch (err: any) {\n      setError(err.message || \"Failed to load initial data\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const checkNumberDuplicate = async (num: string, date: string) => {\n    if (!num || num.trim() === \"\") return;\n    setIsChecking(true);\n    try {\n      const res = await api.checkDuplicateNumber(\"DC\", num, date);\n      setIsDuplicate(res.exists);\n      setConflictType(res.conflict_type || null);\n    } catch (err) {\n      console.error(err);\n      // If check fails, don't block user (fail open)\n      setIsDuplicate(false);\n      setConflictType(null);\n    } finally {\n      setIsChecking(false);\n    }\n  };\n\n  const handleLoadItems = (po: string) => {\n    if (!po) return;\n    loadInitialData(po);\n  };\n\n  const handleSubmit = async () => {\n    setError(null);\n    setIsSubmitting(true);\n\n    // Final client-side validation for quantities\n    for (const item of items) {\n      if (item.dispatch_quantity && item.dispatch_quantity > (item.remaining_post_dc || 0) + 0.001) {\n        setError(`Item Lot ${item.lot_no}: Dispatch quantity (${item.dispatch_quantity}) exceeds remaining balance (${item.remaining_post_dc})`);\n        setIsSubmitting(false);\n        return;\n      }\n    }\n\n    const itemsToDispatch = items.filter(\n      (item) => item.dispatch_quantity && item.dispatch_quantity > 0\n    );\n    if (itemsToDispatch.length === 0) {\n      setError(\"At least one item must have dispatch quantity\");\n      setIsSubmitting(false);\n      return;\n    }\n    try {\n      const dcPayload = {\n        dc_number: formData.dc_number,\n        dc_date: formData.dc_date,\n        po_number: poNumber ? parseInt(poNumber) : undefined,\n        supplier_phone: formData.supplier_phone,\n        supplier_gstin: formData.supplier_gstin,\n        consignee_name: formData.consignee_name,\n        consignee_address: formData.consignee_address,\n        remarks: notes.join(\"\\n\\n\"),\n      };\n      const itemsPayload = itemsToDispatch.map((item) => ({\n        po_item_id: item.po_item_id,\n        lot_no: item.lot_no ? parseInt(item.lot_no.toString()) : undefined,\n        dispatch_qty: item.dispatch_quantity,\n        hsn_code: null,\n        hsn_rate: null,\n      }));\n      const response = (await api.createDC(dcPayload, itemsPayload)) as any;\n      router.push(`/dc/${response.dc_number || formData.dc_number}`);\n    } catch (err: any) {\n      console.error(\"DC creation failed:\", err);\n      // Handle Pydantic 422 errors specifically to show something readable\n      if (err.status === 422 && Array.isArray(err.data?.detail)) {\n        const details = err.data.detail.map((d: any) => `${d.loc.join(\".\")}: ${d.msg}`).join(\", \");\n        setError(`Validation Error: ${details}`);\n      } else if (err.data?.message) {\n        // Handle structured application errors (AppException)\n        setError(err.data.message);\n      } else {\n        const msg =\n          typeof err.message === \"object\"\n            ? JSON.stringify(err.message)\n            : err.message || \"Failed to create challan\";\n        setError(msg);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const topActions = (\n    <div className=\"flex items-center gap-2\">\n      <Button variant=\"outline\" size=\"sm\" onClick={() => router.back()} disabled={isSubmitting}>\n        Cancel\n      </Button>\n      <Button\n        color=\"primary\"\n        size=\"sm\"\n        onClick={handleSubmit}\n        disabled={\n          isSubmitting || items.length === 0 || isDuplicate || isChecking || !formData.dc_number\n        }\n      >\n        {isSubmitting ? (\n          <Loader2 size={16} className=\"animate-spin mr-2\" />\n        ) : (\n          <Save size={16} className=\"mr-2\" />\n        )}\n        {isSubmitting ? \"Generating...\" : \"Generate Challan\"}\n      </Button>\n    </div>\n  );\n\n  return (\n    <DocumentTemplate\n      title=\"Create Delivery Challan\"\n      description=\"Generate dispatch documentation from PO\"\n      actions={topActions}\n      icon={<Truck size={20} className=\"text-emerald-700\" />}\n      iconLayoutId=\"create-dc-icon\"\n    >\n      <div className=\"mb-6\">\n        <DocumentJourney currentStage=\"DC\" />\n      </div>\n\n      <div className=\"space-y-6\">\n        {error && (\n          <Card className=\"p-4 bg-red-50 border-red-100\">\n            <div className=\"flex items-center gap-2 text-red-600\">\n              <AlertCircle size={16} />\n              <SmallText className=\"font-medium\">{error}</SmallText>\n            </div>\n          </Card>\n        )}\n\n        {/* PO Selection */}\n        {!initialPoNumber && (\n          <Card className=\"p-6\">\n            <Label className=\"text-h4 uppercase text-sys-secondary mb-2 block\">\n              Purchase Order Reference\n            </Label>\n            <div className=\"flex gap-3 mt-1\">\n              <div className=\"flex-1\">\n                <Input\n                  id=\"search-po-number\"\n                  name=\"search-po-number\"\n                  value={poNumber}\n                  onChange={(e) => setPONumber(e.target.value)}\n                  placeholder=\"Enter PO number\"\n                  className=\"font-medium text-slate-930\"\n                />\n              </div>\n              <Button\n                variant=\"secondary\"\n                onClick={() => handleLoadItems(poNumber)}\n                disabled={!poNumber || isLoading}\n              >\n                {isLoading ? (\n                  <Loader2 size={16} className=\"animate-spin mr-2\" />\n                ) : (\n                  <Search size={16} className=\"mr-2\" />\n                )}\n                {isLoading ? \"Loading...\" : \"Load Items\"}\n              </Button>\n            </div>\n            {poData && (\n              <div className=\"mt-4 p-4 bg-slate-50/50 rounded-xl border border-slate-100 flex items-center justify-between\">\n                <div className=\"flex flex-col\">\n                  <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                    Supplier\n                  </Label>\n                  <Body className=\"text-sys-primary\">{poData.supplier_name}</Body>\n                </div>\n                <Badge\n                  variant=\"outline\"\n                  className=\"bg-white text-sys-secondary border-slate-200\"\n                >\n                  PO #{poData.po_number}\n                </Badge>\n              </div>\n            )}\n          </Card>\n        )}\n\n        {/* Challan Details */}\n        <Card className=\"p-6\">\n          <H3 className=\"mb-6 text-slate-950\">Challan Information</H3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                DC Number\n              </Label>\n              <Input\n                id=\"dc-number\"\n                name=\"dc-number\"\n                value={formData.dc_number}\n                onChange={(e) => {\n                  const val = e.target.value;\n                  setFormData({ ...formData, dc_number: val });\n\n                  // Clear existing timer\n                  if (debounceTimer) clearTimeout(debounceTimer);\n\n                  // Debounce the duplicate check (500ms delay)\n                  const timer = setTimeout(() => {\n                    checkNumberDuplicate(val, formData.dc_date);\n                  }, 500);\n\n                  setDebounceTimer(timer);\n                }}\n                className={cn(\n                  \"font-medium tabular-nums\",\n                  isDuplicate\n                    ? \"border-red-500 text-red-600 focus:ring-red-500/10\"\n                    : \"text-slate-930\"\n                )}\n                placeholder=\"DC/001/24-25\"\n              />\n              {isChecking && (\n                <SmallText className=\"text-slate-400 animate-pulse\">\n                  Checking uniqueness...\n                </SmallText>\n              )}\n              {isDuplicate && (\n                <SmallText className=\"text-red-500 font-medium\">\n                  {conflictType === \"Invoice\"\n                    ? `ΓÜá∩╕Å Invoice #${formData.dc_number} already exists in this FY`\n                    : `This DC number already exists in this FY`}\n                </SmallText>\n              )}\n\n            </div>\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                DC Date\n              </Label>\n              <div className=\"bg-white/40 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/50 shadow-sm focus-within:ring-2 focus-within:ring-blue-500/10 transition-all flex items-center gap-2\">\n                <Calendar size={14} className=\"text-blue-600\" />\n                <Input\n                  id=\"dc-date\"\n                  name=\"dc-date\"\n                  type=\"date\"\n                  value={formData.dc_date}\n                  onChange={(e) => setFormData({ ...formData, dc_date: e.target.value })}\n                  className=\"font-bold text-slate-800 bg-transparent border-none p-0 focus:ring-0 cursor-pointer text-sm\"\n                />\n              </div>\n            </div>\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                Supplier Phone\n              </Label>\n              <Input\n                id=\"supplier-phone\"\n                name=\"supplier-phone\"\n                value={formData.supplier_phone}\n                onChange={(e) => setFormData({ ...formData, supplier_phone: e.target.value })}\n                className=\"font-medium text-slate-930\"\n              />\n            </div>\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                Supplier GSTIN\n              </Label>\n              <Input\n                id=\"supplier-gstin\"\n                name=\"supplier-gstin\"\n                value={formData.supplier_gstin}\n                onChange={(e) => setFormData({ ...formData, supplier_gstin: e.target.value })}\n                className=\"font-medium text-sys-primary\"\n              />\n            </div>\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                Consignee Name\n              </Label>\n              <Input\n                id=\"consignee-name\"\n                name=\"consignee-name\"\n                value={formData.consignee_name}\n                onChange={(e) => setFormData({ ...formData, consignee_name: e.target.value })}\n                className=\"font-medium text-sys-primary\"\n              />\n            </div>\n            <div className=\"space-y-1.5\">\n              <Label className=\"text-h4 uppercase text-sys-secondary\">\n                Consignee Address\n              </Label>\n              <textarea\n                id=\"consignee-address\"\n                name=\"consignee-address\"\n                value={formData.consignee_address}\n                onChange={(e) =>\n                  setFormData({\n                    ...formData,\n                    consignee_address: e.target.value,\n                  })\n                }\n                className=\"w-full px-3 py-2 text-sys-primary bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-950/10 focus:border-slate-300 resize-none transition-all\"\n                rows={2}\n              />\n            </div>\n          </div>\n        </Card>\n\n        {/* Items Table */}\n        {items.length > 0 && (\n          <Card className=\"p-0 overflow-hidden border-none shadow-sm\">\n            <div className=\"px-6 py-4 bg-slate-50/50 border-b border-slate-100 flex items-center justify-between\">\n              <H3 className=\"font-medium text-slate-950 text-sm\">\n                Dispatch Items ({items.length})\n              </H3>\n            </div>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b border-slate-100 bg-slate-50/30\">\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                        Lot\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                        Description\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                        Ord\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                        Bal\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                        Dlv Qty\n                      </Label>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {items.map((item, idx) => (\n                    <tr\n                      key={item.id}\n                      className=\"border-b border-slate-50 hover:bg-slate-50/20 transition-colors\"\n                    >\n                      <td className=\"py-4 px-6\">\n                        <Accounting className=\"text-sys-primary text-center block\">\n                          {item.lot_no}\n                        </Accounting>\n                      </td>\n                      <td className=\"py-4 px-6\">\n                        <div className=\"flex flex-col\">\n                          <Body className=\"text-slate-950 leading-normal\">\n                            {item.description}\n                          </Body>\n                          {item.drg_no && (\n                            <span className=\"text-h4 uppercase text-sys-tertiary mt-0.5\">\n                              DRG: {item.drg_no}\n                            </span>\n                          )}\n                        </div>\n                      </td>\n                      <td className=\"py-4 px-6 text-right\">\n                        <Accounting className=\"text-sys-secondary text-right block\">\n                          {item.ordered_quantity}\n                        </Accounting>\n                      </td>\n                      <td className=\"py-4 px-6 text-right\">\n                        <Accounting className=\"text-sys-secondary text-right block\">\n                          {item.remaining_post_dc}\n                        </Accounting>\n                      </td>\n                      <td className=\"py-4 px-6\">\n                        <div className=\"flex flex-col items-end gap-1\">\n                          <Input\n                            type=\"number\"\n                            value={item.dispatch_quantity || \"\"}\n                            onChange={(e) => {\n                              const newItems = [...items];\n                              newItems[idx].dispatch_quantity = parseFloat(e.target.value) || 0;\n                              setItems(newItems);\n                            }}\n                            className={cn(\n                              \"text-right max-w-[100px] ml-auto font-mono h-9 transition-all\",\n                              (item.dispatch_quantity || 0) > (item.remaining_post_dc || 0) + 0.001\n                                ? \"border-red-500 text-red-600 focus:ring-red-500/10 bg-red-50/30\"\n                                : \"border-slate-200 focus:ring-slate-950/5\"\n                            )}\n                            placeholder=\"0\"\n                          />\n                          {(item.dispatch_quantity || 0) > (item.remaining_post_dc || 0) + 0.001 && (\n                            <SmallText className=\"text-red-500 font-medium text-[10px]\">\n                              Exceeds bal\n                            </SmallText>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </Card>\n        )}\n\n        {/* Notes */}\n        <Card className=\"p-6\">\n          <Label className=\"text-h4 uppercase text-sys-secondary mb-4 block\">\n            Additional Notes\n          </Label>\n          <div className=\"space-y-3\">\n            {notes.map((note, idx) => (\n              <div key={`lot-${idx}`} className=\"flex gap-2\">\n                <Input\n                  value={note}\n                  onChange={(e) => {\n                    const newNotes = [...notes];\n                    newNotes[idx] = e.target.value;\n                    setNotes(newNotes);\n                  }}\n                  placeholder=\"Enter additional information...\"\n                  className=\"font-medium text-slate-930\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setNotes(notes.filter((_, i) => i !== idx))}\n                  className=\"text-slate-400 hover:text-red-600\"\n                >\n                  <Trash2 size={16} />\n                </Button>\n              </div>\n            ))}\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setNotes([...notes, \"\"])}\n              className=\"border-dashed border-2 hover:border-slate-300\"\n            >\n              <Plus size={16} className=\"mr-2\" />\n              Add Line Note\n            </Button>\n          </div>\n        </Card>\n      </div>\n    </DocumentTemplate>\n  );\n}\n\nexport default function CreateDCPage() {\n  return (\n    <ErrorBoundary>\n      <Suspense\n        fallback={\n          <div className=\"p-32 text-center\">\n            <Body className=\"text-slate-400 animate-pulse\">Loading template...</Body>\n          </div>\n        }\n      >\n        <CreateDCPageContent />\n      </Suspense>\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\dc\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\dc\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\error.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'@/components/design-system/atoms/Card' import is restricted from being used by a pattern. Pages must import Organisms or Templates only to maintain Atomic hierarchy.","line":6,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":6,"endColumn":62},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":18,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":18,"endColumn":18,"suggestions":[{"fix":{"range":[394,440],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect } from \"react\";\nimport { AlertCircle, RefreshCcw, Home } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { Card } from \"@/components/design-system/atoms/Card\";\n\nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string };\n  reset: () => void;\n}) {\n  const router = useRouter();\n\n  useEffect(() => {\n    console.error(\"System Runtime Fault:\", error);\n  }, [error]);\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50/30 p-6\">\n      <Card className=\"max-w-md w-full p-10 text-center space-y-8 border-rose-100 shadow-2xl shadow-rose-100/20\">\n        <div className=\"flex justify-center\">\n          <div className=\"p-6 bg-rose-50 rounded-[2.5rem] border-2 border-rose-100/50 text-rose-600 animate-bounce duration-1000\">\n            <AlertCircle className=\"w-12 h-12\" />\n          </div>\n        </div>\n\n        <div className=\"space-y-3\">\n          <h2 className=\"heading-xl text-rose-700 uppercase tracking-tighter\">Runtime Exception</h2>\n          <p className=\"text-xs text-slate-400 uppercase\">\n            {error.digest || \"PROCESS TERMINATED\"}\n          </p>\n        </div>\n\n        <div className=\"p-6 bg-slate-50/50 rounded-2xl border-2 border-dashed border-slate-100 leading-relaxed text-slate-600 italic\">\n          {error.message ||\n            \"The system encountered an unhandled exception during state reconciliation.\"}\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4 pt-4\">\n          <button\n            onClick={() => router.push(\"/\")}\n            className=\"btn-premium btn-ghost border-slate-200\"\n          >\n            <Home className=\"w-4 h-4\" /> REBOOT HUB\n          </button>\n          <button onClick={reset} className=\"btn-premium btn-primary bg-rose-600 shadow-rose-200\">\n            <RefreshCcw className=\"w-4 h-4\" /> RETRY SYNC\n          </button>\n        </div>\n      </Card>\n    </div>\n  );\n}\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\invoice\\[...id]\\page.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":71,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":71,"endColumn":22,"suggestions":[{"fix":{"range":[2139,2176],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":126,"column":17,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":126,"endColumn":65},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":128,"column":24,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":128,"endColumn":73},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":261,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":261,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":276,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":276,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":282,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":282,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":289,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":289,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":293,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":293,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":304,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":304,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":316,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":316,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":322,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":322,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":328,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":328,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":392,"column":21,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":392,"endColumn":111},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":410,"column":19,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":410,"endColumn":154}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState, Suspense } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport {\n  Printer,\n  FileDown,\n  Receipt,\n} from \"lucide-react\";\nimport { api, API_BASE_URL } from \"@/lib/api\";\nimport { formatDate, formatIndianCurrency, amountInWords } from \"@/lib/utils\";\nimport { normalizeId, dcRoute } from \"@/lib/routes\";\nimport {\n  Body,\n  H3,\n  SmallText,\n  Label,\n  Accounting,\n  Button,\n  Badge,\n  Card,\n} from \"@/components/design-system/organisms\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport {\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n} from \"@/components/design-system/molecules/Tabs\";\nimport { type Column } from \"@/components/design-system/organisms/DataTable\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport dynamic from \"next/dynamic\";\nimport { DetailSkeleton } from \"@/components/design-system/molecules/skeletons/DetailSkeleton\";\n\nconst DataTable = dynamic(\n  () => import(\"@/components/design-system/organisms/DataTable\").then((mod) => mod.DataTable),\n  {\n    loading: () => <div className=\"h-64 w-full bg-[var(--color-sys-bg-tertiary)]/50 rounded-xl animate-pulse\" />,\n    ssr: false,\n  }\n);\n\nconst DocumentJourney = dynamic(\n  () =>\n    import(\"@/components/design-system/molecules/DocumentJourney\").then(\n      (mod) => mod.DocumentJourney\n    ),\n  {\n    loading: () => <div className=\"h-6 w-48 bg-[var(--color-sys-bg-tertiary)] rounded-full animate-pulse\" />,\n    ssr: false,\n  }\n);\n\nfunction InvoiceDetailContent() {\n  const router = useRouter();\n  const params = useParams();\n  const invoiceId = normalizeId(params?.id as string | string[] || \"\");\n  const [data, setData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState(\"buyer\");\n\n  useEffect(() => {\n    if (!invoiceId) return;\n    let isMounted = true;\n\n    const loadData = async () => {\n      try {\n        const invoiceData = await api.getInvoiceDetail(decodeURIComponent(invoiceId));\n        if (isMounted) setData(invoiceData);\n      } catch (err) {\n        console.error(\"Invoice Error:\", err);\n      } finally {\n        if (isMounted) setLoading(false);\n      }\n    };\n    loadData();\n\n    return () => {\n      isMounted = false;\n    };\n  }, [invoiceId]);\n\n  if (loading || !data || !data.header) {\n    return <DetailSkeleton />;\n  }\n\n  const { header, items = [], linked_dcs = [] } = data;\n\n  const topActions = (\n    <div className=\"flex gap-3\">\n      <Button\n        variant=\"outline\"\n        size=\"sm\"\n        asChild\n        className=\"text-emerald-700 border-emerald-200 bg-emerald-50 hover:bg-emerald-100 hover:text-emerald-800\"\n      >\n        <a\n          href={`${API_BASE_URL}/api/invoice/${encodeURIComponent(header.invoice_number)}/download`}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          <FileDown size={16} className=\"mr-2\" />\n          Excel\n        </a>\n      </Button>\n      <Button variant=\"outline\" size=\"sm\" onClick={() => window.print()}>\n        <Printer size={16} />\n        Print\n      </Button>\n    </div>\n  );\n\n  const itemColumns: Column<any>[] = [\n    {\n      key: \"material_code\",\n      label: \"Code\",\n      width: \"12%\",\n      render: (v) => <Accounting className=\"table-cell-number\">{v}</Accounting>,\n    },\n    {\n      key: \"description\",\n      label: \"Description\",\n      width: \"32%\",\n      render: (_v, row) => (\n        <div className=\"space-y-0.5\">\n          <Body className=\"text-[var(--color-sys-text-primary)]\">{row.material_description || row.description}</Body>\n          {row.drg_no && (\n            <SmallText className=\"text-[var(--color-sys-brand-primary)]\">\n              DRG: {row.drg_no}\n            </SmallText>\n          )}\n        </div>\n      ),\n    },\n    {\n      key: \"ordered_quantity\",\n      label: \"Ord\",\n      align: \"right\",\n      width: \"8%\",\n      isNumeric: true,\n      render: (v: any) => (\n        <Accounting className=\"table-cell-number text-right block\">{v}</Accounting>\n      ),\n    },\n    {\n      key: \"dispatched_quantity\",\n      label: \"Dlv\",\n      align: \"right\",\n      width: \"8%\",\n      isNumeric: true,\n      render: (v: any) => (\n        <Accounting className=\"table-cell-number text-right block\">{v}</Accounting>\n      ),\n    },\n    {\n      key: \"quantity\",\n      label: \"Inv\",\n      align: \"right\",\n      width: \"8%\",\n      isNumeric: true,\n      render: (v) => (\n        <Accounting className=\"table-cell-number text-sys-success text-right block\">\n          {v || 0}\n        </Accounting>\n      ),\n    },\n    {\n      key: \"unit\",\n      label: \"Unit\",\n      width: \"6%\",\n      render: (v) => (\n        <SmallText className=\"text-sys-secondary uppercase font-black tracking-widest\">{v}</SmallText>\n      ),\n    },\n    {\n      key: \"rate\",\n      label: \"Rate\",\n      align: \"right\",\n      width: \"10%\",\n      isCurrency: true,\n      render: (v: any) => (\n        <Accounting className=\"table-cell-number text-right block\">\n          {formatIndianCurrency(v)}\n        </Accounting>\n      ),\n    },\n    {\n      key: \"amount\",\n      label: \"Amount\",\n      align: \"right\",\n      width: \"10%\",\n      isCurrency: true,\n      render: (v: any) => (\n        <Accounting className=\"table-cell-number text-right block\">\n          {formatIndianCurrency(v)}\n        </Accounting>\n      ),\n    },\n  ];\n\n  return (\n    <DocumentTemplate\n      title={`Invoice #${header.invoice_number}`}\n      description={`${header.buyer_name} ΓÇó ${formatDate(header.invoice_date)}`}\n      actions={topActions}\n      onBack={() => router.back()}\n      layoutId={`inv-title-${header.invoice_number}`}\n      icon={<Receipt size={20} className=\"text-blue-700\" />}\n      iconLayoutId={`inv-icon-${header.invoice_number}`}\n      status={header.status}\n    >\n      <div className=\"space-y-6\">\n        <DocumentJourney currentStage=\"Invoice\" className=\"mb-2\" />\n\n        {/* Invoice Info Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"mb-4 bg-transparent p-0 border-b border-sys-tertiary/10\">\n            <TabsTrigger value=\"buyer\">Buyer</TabsTrigger>\n            <TabsTrigger value=\"references\">Order Refs</TabsTrigger>\n            <TabsTrigger value=\"logistics\">Logistics</TabsTrigger>\n          </TabsList>\n\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={activeTab}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.15 }}\n            >\n              <Card className=\"p-6 mt-0 border-none shadow-sm bg-[var(--color-sys-bg-surface)]/50 backdrop-blur-sm relative top-[-1px]\">\n                <TabsContent value=\"buyer\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>Buyer Name</Label>\n                      <Body className=\"text-sys-primary font-medium\">\n                        {header.buyer_name || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Buyer GSTIN</Label>\n                      <Accounting>{header.buyer_gstin || \"-\"}</Accounting>\n                    </div>\n                    <div className=\"space-y-1.5 col-span-2\">\n                      <Label>Buyer Address</Label>\n                      <Body className=\"text-sys-primary font-medium\">\n                        {header.buyer_address || \"-\"}\n                      </Body>\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"references\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>Buyer's Order No</Label>\n                      <Accounting>{header.buyers_order_no || \"-\"}</Accounting>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Order Date</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.buyers_order_date ? formatDate(header.buyers_order_date) : \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Challan Number</Label>\n                      <Accounting\n                        className=\"text-sys-brand cursor-pointer hover:underline\"\n                        onClick={() => router.push(dcRoute(header.dc_number))}\n                      >\n                        {header.dc_number || \"-\"}\n                      </Accounting>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>GEMC Number</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.gemc_number || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>GEMC Date</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.gemc_date ? formatDate(header.gemc_date) : \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">{/* Spacer or additional field */}</div>\n                    <div className=\"space-y-1.5\">\n                      <Label>SRV Number</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">{header.srv_no || \"-\"}</Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>SRV Date</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.srv_date ? formatDate(header.srv_date) : \"-\"}\n                      </Body>\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"logistics\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label>Dispatch Through</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.dispatch_through || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Destination</Label>\n                      <Body className=\"text-sys-primary font-medium\">\n                        {header.destination || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Terms of Delivery</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.terms_of_delivery || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label>Despatch Document No</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.despatch_doc_no || \"-\"}\n                      </Body>\n                    </div>\n                    <div className=\"space-y-1.5 col-span-2\">\n                      <Label>Payment Terms</Label>\n                      <Body className=\"text-[var(--color-sys-text-primary)] font-medium\">\n                        {header.payment_terms || header.mode_of_payment || \"45 Days\"}\n                      </Body>\n                    </div>\n                  </div>\n                </TabsContent>\n              </Card>\n            </motion.div>\n          </AnimatePresence>\n        </Tabs>\n\n        {/* Items Table */}\n        <div className=\"space-y-2\">\n          <H3 className=\"px-1 font-medium text-sys-secondary uppercase tracking-widest\">\n            Invoice Items ({items.length})\n          </H3>\n          <DataTable\n            columns={itemColumns}\n            data={items.map((item: any, idx: number) => ({\n              ...item,\n              _uniqueKey: `item-${idx}-${item.id || idx}`,\n            }))}\n            keyField=\"_uniqueKey\"\n            density=\"compact\"\n          />\n        </div>\n\n        {/* Totals */}\n        <Card className=\"p-6 bg-[var(--color-sys-bg-secondary)]/50 border-none shadow-sm\">\n          <div className=\"grid grid-cols-2 gap-4 max-w-sm ml-auto\">\n            <Label className=\"uppercase tracking-widest text-sys-secondary flex items-center\">\n              Taxable Value:\n            </Label>\n            <Accounting className=\"text-right\">\n              {formatIndianCurrency(header.total_taxable_value)}\n            </Accounting>\n\n            <Label className=\"uppercase tracking-widest text-sys-secondary flex items-center\">\n              CGST @ 9%:\n            </Label>\n            <Accounting className=\"text-right\">\n              {formatIndianCurrency(header.cgst_total)}\n            </Accounting>\n\n            <Label className=\"uppercase tracking-widest text-sys-secondary flex items-center\">\n              SGST @ 9%:\n            </Label>\n            <Accounting className=\"text-right\">\n              {formatIndianCurrency(header.sgst_total)}\n            </Accounting>\n\n            <div className=\"col-span-2 border-t border-slate-200 my-2\" />\n\n            <Label className=\"text-sys-secondary flex items-center\">\n              Grand Total:\n            </Label>\n            <Accounting className=\"text-right text-sys-primary\">\n              {formatIndianCurrency(header.total_invoice_value)}\n            </Accounting>\n\n            <div className=\"col-span-2 mt-4 space-y-1 bg-[var(--color-sys-bg-surface)]/50 p-3 rounded-lg border border-[var(--color-sys-bg-tertiary)]\">\n              <Label className=\"text-sys-tertiary\">\n                Amount in words\n              </Label>\n              <Body className=\"text-[var(--color-sys-text-secondary)] italic lowercase first-letter:uppercase\">\n                {amountInWords(header.total_invoice_value)} Only\n              </Body>\n            </div>\n          </div>\n        </Card>\n\n        {/* Linked DCs */}\n        {linked_dcs && linked_dcs.length > 0 && (\n          <Card className=\"p-6 border-none shadow-sm bg-[var(--color-sys-bg-secondary)]/30\">\n            <H3 className=\"mb-4 text-sys-secondary\">\n              Linked Delivery Challans\n            </H3>\n            <div className=\"flex gap-2 flex-wrap\">\n              {linked_dcs.map((dc: any) => (\n                <Badge\n                  key={dc.dc_number}\n                  variant=\"outline\"\n                  className=\"cursor-pointer hover:bg-[var(--color-sys-bg-tertiary)] transition-colors font-medium text-[var(--color-sys-text-secondary)]\"\n                  onClick={() => router.push(dcRoute(dc.dc_number))}\n                >\n                  {dc.dc_number}\n                </Badge>\n              ))}\n            </div>\n          </Card>\n        )}\n      </div>\n    </DocumentTemplate>\n  );\n}\n\nexport default function InvoiceDetailPage() {\n  return (\n    <Suspense fallback={<DetailSkeleton />}>\n      <InvoiceDetailContent />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\invoice\\create\\page.tsx","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'@/components/design-system/atoms/Typography' import is restricted from being used by a pattern. Pages must import Organisms or Templates only to maintain Atomic hierarchy.","line":14,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":20,"endColumn":54},{"ruleId":"no-restricted-imports","severity":2,"message":"'@/components/design-system/atoms/Button' import is restricted from being used by a pattern. Pages must import Organisms or Templates only to maintain Atomic hierarchy.","line":23,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":23,"endColumn":66},{"ruleId":"no-restricted-imports","severity":2,"message":"'@/components/design-system/atoms/Input' import is restricted from being used by a pattern. Pages must import Organisms or Templates only to maintain Atomic hierarchy.","line":24,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":24,"endColumn":64},{"ruleId":"no-restricted-imports","severity":2,"message":"'@/components/design-system/atoms/Card' import is restricted from being used by a pattern. Pages must import Organisms or Templates only to maintain Atomic hierarchy.","line":25,"column":1,"nodeType":"ImportDeclaration","messageId":"patternWithCustomMessage","endLine":25,"endColumn":62},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":71,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":71,"endColumn":20,"suggestions":[{"fix":{"range":[2647,2692],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":100,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":100,"endColumn":20,"suggestions":[{"fix":{"range":[3508,3527],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":234,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":234,"endColumn":20,"suggestions":[{"fix":{"range":[8017,8064],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useState, Suspense, useCallback } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { cn } from \"@/lib/utils\";\nimport { Save, Loader2, AlertCircle, Search, ChevronDown, Check, X, CheckCircle2 } from \"lucide-react\";\nimport { api, type Buyer } from \"@/lib/api\";\nimport type { InvoiceFormData, InvoiceItemUI } from \"@/types/ui\";\nimport { createDefaultInvoiceForm } from \"@/lib/uiAdapters\";\nimport { amountInWords, formatIndianCurrency } from \"@/lib/utils\";\nimport * as Select from \"@radix-ui/react-select\";\nimport { motion } from \"framer-motion\";\nimport {\n  H3,\n  Label,\n  SmallText,\n  Body,\n  Accounting,\n} from \"@/components/design-system/atoms/Typography\";\nimport { DocumentJourney } from \"@/components/design-system/molecules/DocumentJourney\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport { Button } from \"@/components/design-system/atoms/Button\";\nimport { Input } from \"@/components/design-system/atoms/Input\";\nimport { Card } from \"@/components/design-system/atoms/Card\";\n\nconst TAX_RATES = { cgst: 9.0, sgst: 9.0 };\n\nfunction CreateInvoicePageContent() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const dcId = searchParams?.get(\"dc\") || \"\";\n\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [invoiceItems, setInvoiceItems] = useState<InvoiceItemUI[]>([]);\n  const [manualDcId, setManualDcId] = useState(dcId);\n  const [formData, setFormData] = useState<InvoiceFormData>(\n    createDefaultInvoiceForm(dcId || undefined)\n  );\n\n  // Multi-Buyer States\n  const [buyers, setBuyers] = useState<Buyer[]>([]);\n  const [selectedBuyerId, setSelectedBuyerId] = useState<string>(\"\");\n\n  const [isDuplicate, setIsDuplicate] = useState(false);\n  const [isChecking, setIsChecking] = useState(false);\n  const [showWarning, setShowWarning] = useState(false);\n\n  useEffect(() => {\n    fetchInitialData();\n  }, [dcId]);\n\n  const fetchInitialData = async () => {\n    try {\n      const buyerList = await api.getBuyers();\n      setBuyers(buyerList);\n\n      const defaultBuyer = buyerList.find((b) => b.is_default);\n      if (defaultBuyer) {\n        setSelectedBuyerId(defaultBuyer.id.toString());\n        applyBuyerToForm(defaultBuyer);\n      } else if (buyerList.length > 0) {\n        setSelectedBuyerId(buyerList[0].id.toString());\n        applyBuyerToForm(buyerList[0]);\n      }\n\n      if (dcId) loadDC(dcId);\n    } catch (err) {\n      console.error(\"Failed to fetch buyers\", err);\n    }\n  };\n\n  const applyBuyerToForm = (buyer: Buyer) => {\n    setFormData((prev) => ({\n      ...prev,\n      buyer_name: buyer.name,\n      buyer_gstin: buyer.gstin,\n      buyer_address: buyer.billing_address,\n      buyer_state: buyer.state || \"\",\n      buyer_state_code: buyer.state_code || \"\",\n      place_of_supply: buyer.place_of_supply,\n    }));\n  };\n\n  const handleBuyerChange = (id: string) => {\n    setSelectedBuyerId(id);\n    const buyer = buyers.find((b) => b.id.toString() === id);\n    if (buyer) applyBuyerToForm(buyer);\n  };\n\n  const checkNumberDuplicate = async (num: string, date: string) => {\n    if (!num || num.length < 3) return;\n    setIsChecking(true);\n    try {\n      const res = await api.checkDuplicateNumber(\"Invoice\", num, date);\n      setIsDuplicate(res.exists);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setIsChecking(false);\n    }\n  };\n\n  const loadDC = useCallback(async (id: string) => {\n    if (!id) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const data = await api.getDCDetail(id);\n\n      if (!data?.header) {\n        setError(\"Challan not found.\");\n        setLoading(false);\n        return;\n      }\n\n      setFormData((prev) => ({\n        ...prev,\n        dc_number: data.header.dc_number || \"\",\n        challan_date: data.header.dc_date || \"\",\n        buyers_order_no: data.header.po_number?.toString() || \"\",\n        buyers_order_date: data.header.po_date || \"\",\n        vehicle_no: data.header.vehicle_no || \"\",\n        lr_no: data.header.lr_no || \"\",\n        transporter: data.header.transporter || \"\",\n        destination: (data.header as any).destination || \"\",\n      }));\n\n      if (data.items?.length > 0) {\n        const items: InvoiceItemUI[] = data.items.map((item: any) => {\n          const qty = item.dispatched_quantity || item.dispatch_qty || 0;\n          const rate = item.po_rate || 0;\n          const taxableValue = qty * rate;\n          const cgstAmount = (taxableValue * TAX_RATES.cgst) / 100;\n          const sgstAmount = (taxableValue * TAX_RATES.sgst) / 100;\n          return {\n            lotNumber: item.lot_no?.toString() || \"\",\n            description: item.description || item.material_description || \"\",\n            hsnCode: item.hsn_code || \"\",\n            quantity: qty,\n            unit: \"NO\",\n            rate: rate,\n            taxableValue,\n            tax: {\n              cgstRate: TAX_RATES.cgst,\n              cgstAmount,\n              sgstRate: TAX_RATES.sgst,\n              sgstAmount,\n              igstRate: 0,\n              igstAmount: 0,\n            },\n            totalAmount: taxableValue + cgstAmount + sgstAmount,\n          };\n        });\n        setInvoiceItems(items);\n        calculateTotals(items);\n      }\n    } catch (err: any) {\n      setError(err.message || \"Failed to load DC\");\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const calculateTotals = (items: InvoiceItemUI[]) => {\n    const taxable = items.reduce((sum, item) => sum + item.taxableValue, 0);\n    const cgst = items.reduce((sum, item) => sum + item.tax.cgstAmount, 0);\n    const sgst = items.reduce((sum, item) => sum + item.tax.sgstAmount, 0);\n    const total = items.reduce((sum, item) => sum + item.totalAmount, 0);\n\n    const validTotal = isNaN(total) ? 0 : total;\n\n    setFormData(\n      (prev) =>\n        ({\n          ...prev,\n          taxable_value: isNaN(taxable) ? 0 : taxable,\n          cgst: isNaN(cgst) ? 0 : cgst,\n          sgst: isNaN(sgst) ? 0 : sgst,\n          total_invoice_value: validTotal,\n          amount_in_words: amountInWords(validTotal),\n        }) as any\n    );\n  };\n\n  const handleSave = async () => {\n    setShowWarning(false);\n    setSaving(true);\n    setError(null);\n    try {\n      const apiItems = invoiceItems.map((item) => ({\n        po_sl_no: item.lotNumber,\n        description: item.description,\n        quantity: item.quantity,\n        unit: item.unit || \"NO\",\n        rate: item.rate,\n        hsn_sac: item.hsnCode,\n        no_of_packets: (item as any).no_of_packets,\n      }));\n\n      const payload = {\n        invoice_number: formData.invoice_number,\n        invoice_date: formData.invoice_date,\n        dc_number: formData.dc_number,\n        buyer_name: formData.buyer_name,\n        buyer_address: (formData as any).buyer_address,\n        buyer_gstin: formData.buyer_gstin,\n        buyer_state: formData.buyer_state,\n        buyer_state_code: (formData as any).buyer_state_code,\n        place_of_supply: formData.place_of_supply,\n        buyers_order_no: formData.buyers_order_no,\n        buyers_order_date: formData.buyers_order_date,\n        vehicle_no: formData.vehicle_no,\n        lr_no: formData.lr_no,\n        transporter: formData.transporter,\n        destination: formData.destination,\n        terms_of_delivery: formData.terms_of_delivery,\n        gemc_number: formData.gemc_number,\n        gemc_date: formData.gemc_date,\n        mode_of_payment: formData.mode_of_payment,\n        payment_terms: formData.payment_terms || \"45 Days\",\n        despatch_doc_no: formData.despatch_doc_no,\n        srv_no: formData.srv_no,\n        srv_date: formData.srv_date,\n        remarks: formData.remarks,\n        items: apiItems,\n      };\n\n      await api.createInvoice(payload);\n      router.push(`/invoice/${formData.invoice_number}`);\n    } catch (err: any) {\n      console.error(\"Invoice creation failed:\", err);\n      if (err.status === 422 && Array.isArray(err.data?.detail)) {\n        const details = err.data.detail.map((d: any) => `${d.loc.join(\".\")}: ${d.msg}`).join(\", \");\n        setError(`Validation Error: ${details}`);\n      } else {\n        const msg = err.message || \"Failed to create invoice\";\n        setError(msg);\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const topActions = (\n    <div className=\"flex items-center gap-2\">\n      <Button variant=\"outline\" size=\"sm\" onClick={() => router.back()} disabled={saving}>\n        Cancel\n      </Button>\n      <Button\n        variant=\"default\"\n        size=\"sm\"\n        onClick={() => setShowWarning(true)}\n        disabled={\n          saving ||\n          invoiceItems.length === 0 ||\n          isDuplicate ||\n          isChecking ||\n          !formData.invoice_number\n        }\n      >\n        {saving ? (\n          <Loader2 size={16} className=\"animate-spin mr-2\" />\n        ) : (\n          <Save size={16} className=\"mr-2\" />\n        )}\n        {saving ? \"Saving...\" : \"Generate Invoice\"}\n      </Button>\n    </div>\n  );\n\n  return (\n    <DocumentTemplate\n      title=\"Create GST Invoice\"\n      description=\"Generate billing documentation from DC\"\n      actions={topActions}\n    >\n      <div className=\"mb-6\">\n        <DocumentJourney currentStage=\"Invoice\" />\n      </div>\n\n      <div className=\"space-y-6\">\n        {error && (\n          <Card className=\"p-4 bg-red-50 border-red-100\">\n            <div className=\"flex items-center gap-2 text-red-600\">\n              <AlertCircle size={16} />\n              <SmallText className=\"font-medium\">{error}</SmallText>\n            </div>\n          </Card>\n        )}\n\n        {/* DC Selection */}\n        {!dcId && (\n          <Card className=\"p-6\">\n            <Label className=\"text-h4 uppercase text-sys-secondary mb-2 block\">\n              Delivery Challan Reference\n            </Label>\n            <div className=\"flex gap-3 mt-1\">\n              <div className=\"flex-1\">\n                <Input\n                  value={manualDcId}\n                  onChange={(e) => setManualDcId(e.target.value)}\n                  placeholder=\"Enter DC number\"\n                  className=\"font-medium text-sys-primary\"\n                />\n              </div>\n              <Button\n                variant=\"secondary\"\n                onClick={() => loadDC(manualDcId)}\n                disabled={!manualDcId || loading}\n              >\n                {loading ? (\n                  <Loader2 size={16} className=\"animate-spin mr-2\" />\n                ) : (\n                  <Search size={16} className=\"mr-2\" />\n                )}\n                {loading ? \"Loading...\" : \"Load DC\"}\n              </Button>\n            </div>\n          </Card>\n        )}\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Invoice Details */}\n            <Card className=\"p-6\">\n              <H3 className=\"mb-6 text-slate-950 text-sm\">Invoice Information</H3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6\">\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Invoice Number\n                  </Label>\n                  <Input\n                    value={formData.invoice_number}\n                    onChange={(e) => {\n                      const val = e.target.value;\n                      setFormData({ ...formData, invoice_number: val });\n                      checkNumberDuplicate(val, formData.invoice_date);\n                    }}\n                    className={cn(\n                      \"font-medium tabular-nums\",\n                      isDuplicate\n                        ? \"border-red-500 text-red-600 focus:ring-red-500/10\"\n                        : \"text-slate-930\"\n                    )}\n                    placeholder=\"INV/001/24-25\"\n                  />\n                  {isChecking && (\n                    <SmallText className=\"text-slate-400 animate-pulse\">\n                      Checking uniqueness...\n                    </SmallText>\n                  )}\n                  {isDuplicate && (\n                    <SmallText className=\"text-red-500\">\n                      This number already exists in this FY\n                    </SmallText>\n                  )}\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Invoice Date\n                  </Label>\n                  <Input\n                    type=\"date\"\n                    value={formData.invoice_date}\n                    onChange={(e) => setFormData({ ...formData, invoice_date: e.target.value })}\n                    className=\"font-medium text-slate-930\"\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                    Linked DC\n                  </Label>\n                  <div className=\"font-medium text-slate-950 tabular-nums px-3 py-2 bg-slate-50/50 rounded-xl border border-dashed border-slate-200\">\n                    {formData.dc_number || \"---\"}\n                  </div>\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-tertiary\">\n                    Order Reference\n                  </Label>\n                  <div className=\"font-medium text-slate-950 px-3 py-2 bg-slate-50/50 rounded-xl border border-dashed border-slate-200\">\n                    {formData.buyers_order_no || \"---\"}\n                  </div>\n                </div>\n              </div>\n            </Card>\n\n            <Card className=\"p-6\">\n              <H3 className=\"mb-6 text-slate-950 text-sm\">Logistics & Payments</H3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6\">\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Vehicle No\n                  </Label>\n                  <Input\n                    value={formData.vehicle_no || \"\"}\n                    onChange={(e) => setFormData({ ...formData, vehicle_no: e.target.value })}\n                    className=\"font-medium text-sys-primary\"\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Transporter\n                  </Label>\n                  <Input\n                    value={formData.transporter || \"\"}\n                    onChange={(e) => setFormData({ ...formData, transporter: e.target.value })}\n                    className=\"font-medium text-sys-primary\"\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Payment Terms\n                  </Label>\n                  <Input\n                    value={formData.payment_terms || \"45 Days\"}\n                    onChange={(e) => setFormData({ ...formData, payment_terms: e.target.value })}\n                    className=\"font-medium text-sys-primary\"\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <Label className=\"text-h4 uppercase text-sys-secondary\">\n                    Mode of Payment\n                  </Label>\n                  <Input\n                    value={formData.mode_of_payment || \"\"}\n                    onChange={(e) => setFormData({ ...formData, mode_of_payment: e.target.value })}\n                    className=\"font-medium text-sys-primary\"\n                  />\n                </div>\n              </div>\n            </Card>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Buyer Selection Card */}\n            <Card className=\"p-6 border-blue-50 bg-blue-50/20 ring-1 ring-blue-100\">\n              <Label className=\"text-h4 uppercase text-sys-brand mb-4 block\">\n                Bill To: Entity Selection\n              </Label>\n\n              <Select.Root value={selectedBuyerId} onValueChange={handleBuyerChange}>\n                <Select.Trigger className=\"flex items-center justify-between w-full px-4 py-2 bg-white border border-blue-200 rounded-xl text-sm text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all\">\n                  <Select.Value placeholder=\"Select Buyer\" />\n                  <Select.Icon>\n                    <ChevronDown size={14} className=\"text-blue-400\" />\n                  </Select.Icon>\n                </Select.Trigger>\n                <Select.Portal>\n                  <Select.Content className=\"overflow-hidden bg-white rounded-xl shadow-xl border border-slate-100 z-50\">\n                    <Select.Viewport className=\"p-1\">\n                      {buyers.map((b) => (\n                        <Select.Item\n                          key={b.id}\n                          value={b.id.toString()}\n                          className=\"flex items-center px-8 py-2 text-sm text-slate-700 rounded-lg outline-none hover:bg-blue-50 hover:text-blue-700 cursor-pointer relative data-[highlighted]:bg-blue-50\"\n                        >\n                          <Select.ItemText>{b.name}</Select.ItemText>\n                          <Select.ItemIndicator className=\"absolute left-2\">\n                            <Check size={14} />\n                          </Select.ItemIndicator>\n                        </Select.Item>\n                      ))}\n                    </Select.Viewport>\n                  </Select.Content>\n                </Select.Portal>\n              </Select.Root>\n\n              <div className=\"mt-8 pt-6 border-t border-blue-100 space-y-4\">\n                <div>\n                  <Label>Live Snapshot</Label>\n                  <H3 className=\"text-slate-950 leading-tight\">\n                    {formData.buyer_name || \"---\"}\n                  </H3>\n                </div>\n                <div className=\"space-y-1\">\n                  <Label>GSTIN</Label>\n                  <Accounting className=\"text-h4 text-sys-brand\">\n                    {formData.buyer_gstin || \"---\"}\n                  </Accounting>\n                </div>\n                <div className=\"space-y-1\">\n                  <Label>Billing Address</Label>\n                  <SmallText className=\"text-sys-secondary block leading-relaxed\">\n                    {formData.buyer_address || \"---\"}\n                  </SmallText>\n                </div>\n                <div className=\"flex items-center gap-4\">\n                  <div>\n                    <Label>State</Label>\n                    <SmallText className=\"font-bold text-slate-800\">\n                      {formData.buyer_state || \"---\"}\n                    </SmallText>\n                  </div>\n                  <div>\n                    <Label>POS</Label>\n                    <SmallText className=\"font-bold text-slate-800\">\n                      {formData.place_of_supply || \"---\"}\n                    </SmallText>\n                  </div>\n                </div>\n              </div>\n            </Card>\n          </div>\n        </div>\n\n        {/* Items Table */}\n        {invoiceItems.length > 0 && (\n          <Card className=\"p-0 overflow-hidden border-none shadow-sm\">\n            <div className=\"px-6 py-4 bg-slate-50/50 border-b border-slate-100\">\n              <H3 className=\"font-medium text-slate-950\">\n                Invoice Items ({invoiceItems.length})\n              </H3>\n            </div>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b border-slate-100 bg-slate-50/30\">\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label>Lot</Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label>Description</Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label>HSN</Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label>Qty</Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label>Rate</Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label>Total</Label>\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {invoiceItems.map((item, idx) => (\n                    <tr\n                      key={`item-${idx}`}\n                      className=\"border-b border-slate-50 hover:bg-slate-50/10 transition-colors\"\n                    >\n                      <td className=\"py-2 px-6\">\n                        <Accounting className=\"font-medium text-slate-930 font-mono\">\n                          {item.lotNumber}\n                        </Accounting>\n                      </td>\n                      <td className=\"py-2 px-6 text-slate-950\">{item.description}</td>\n                      <td className=\"py-2 px-6 font-mono text-slate-500\">\n                        {item.hsnCode}\n                      </td>\n                      <td className=\"py-2 px-6 text-right\">\n                        <Accounting className=\"text-sys-secondary text-right block\">\n                          {item.quantity}\n                        </Accounting>\n                      </td>\n                      <td className=\"py-2 px-6 text-right text-slate-600 font-mono\">\n                        {formatIndianCurrency(item.rate)}\n                      </td>\n                      <td className=\"py-2 px-6 text-right text-slate-950\">\n                        <Accounting isCurrency className=\"font-mono text-right block\">\n                          {item.totalAmount}\n                        </Accounting>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n            <div className=\"bg-slate-50/50 border-t border-slate-100 p-8\">\n              <div className=\"grid grid-cols-2 gap-x-12 gap-y-4 max-w-sm ml-auto\">\n                <Label>Taxable Value</Label>\n                <Accounting isCurrency className=\"text-right text-sys-secondary\">\n                  {formData.taxable_value || 0}\n                </Accounting>\n\n                <Label>CGST @ 9%</Label>\n                <Accounting isCurrency className=\"text-right text-slate-600\">\n                  {formData.cgst || 0}\n                </Accounting>\n\n                <Label>SGST @ 9%</Label>\n                <Accounting isCurrency className=\"text-right text-slate-600\">\n                  {formData.sgst || 0}\n                </Accounting>\n\n                <div className=\"col-span-2 my-2 border-t border-slate-200\"></div>\n\n                <Label className=\"text-small leading-tight text-sys-primary\">\n                  Grand Total\n                </Label>\n                <Accounting isCurrency className=\"text-right text-xl text-sys-primary\">\n                  {formData.total_invoice_value}\n                </Accounting>\n\n                <div className=\"col-span-2 mt-4 text-right\">\n                  <SmallText className=\"italic text-slate-500\">\n                    {(formData as any).amount_in_words || \"---\"} Only\n                  </SmallText>\n                </div>\n              </div>\n            </div>\n          </Card>\n        )}\n      </div>\n\n      {/* Invoice Generation Warning Modal */}\n      {showWarning && (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm\"\n          onClick={() => setShowWarning(false)}\n        >\n          <motion.div\n            initial={{ scale: 0.95, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            exit={{ scale: 0.95, opacity: 0 }}\n            transition={{ type: \"spring\", duration: 0.3 }}\n            onClick={(e: React.MouseEvent) => e.stopPropagation()}\n            className=\"relative w-full max-w-md\"\n          >\n            <Card className=\"p-0 overflow-hidden border-none shadow-2xl bg-white/95 backdrop-blur-xl\">\n              {/* Header with gradient */}\n              <div className=\"relative px-6 pt-6 pb-4 bg-gradient-to-br from-amber-50 to-orange-50 border-b border-amber-100\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg\">\n                    <AlertCircle className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <H3 className=\"text-slate-900 mb-1\">ΓÜá∩╕Å Critical Warning</H3>\n                    <SmallText className=\"text-slate-600\">\n                      Please read carefully before proceeding\n                    </SmallText>\n                  </div>\n                </div>\n              </div>\n\n              {/* Content */}\n              <div className=\"p-6 space-y-4\">\n                <div className=\"p-4 rounded-xl bg-amber-50 border border-amber-200\">\n                  <Body className=\"text-slate-800 leading-relaxed\">\n                    Once this <strong className=\"text-amber-700\">Invoice is generated</strong>, it{\" \"}\n                    <strong className=\"text-red-600\">cannot be modified or deleted</strong>.\n                  </Body>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label className=\"text-slate-700 font-medium flex items-center gap-2\">\n                    <span className=\"w-1.5 h-1.5 rounded-full bg-slate-400\"></span>\n                    The invoice will be permanently locked\n                  </Label>\n                  <Label className=\"text-slate-700 font-medium flex items-center gap-2\">\n                    <span className=\"w-1.5 h-1.5 rounded-full bg-slate-400\"></span>\n                    The linked DC will also be locked from editing\n                  </Label>\n                  <Label className=\"text-slate-700 font-medium flex items-center gap-2\">\n                    <span className=\"w-1.5 h-1.5 rounded-full bg-slate-400\"></span>\n                    Ensure all details are correct before proceeding\n                  </Label>\n                </div>\n              </div>\n\n              {/* Footer Actions */}\n              <div className=\"px-6 py-4 bg-slate-50 border-t border-slate-100 flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setShowWarning(false)}\n                  className=\"flex-1 border-slate-300 hover:bg-slate-100\"\n                >\n                  <X size={16} className=\"mr-2\" />\n                  Cancel\n                </Button>\n                <Button\n                  variant=\"default\"\n                  size=\"sm\"\n                  onClick={handleSave}\n                  className=\"flex-1 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white shadow-lg\"\n                >\n                  <CheckCircle2 size={16} className=\"mr-2\" />\n                  I Understand, Proceed\n                </Button>\n              </div>\n            </Card>\n          </motion.div>\n        </motion.div>\n      )}\n    </DocumentTemplate>\n  );\n}\n\nexport default function CreateInvoicePage() {\n  return (\n    <ErrorBoundary>\n      <Suspense\n        fallback={\n          <div className=\"p-32 text-center\">\n            <Body className=\"text-slate-400 animate-pulse\">Loading template...</Body>\n          </div>\n        }\n      >\n        <CreateInvoicePageContent />\n      </Suspense>\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\invoice\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\invoice\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\loading.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[42,81],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'motion' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from \"react\";\nimport { motion } from \"framer-motion\";\n\nexport default function Loading() {\n  return (\n    <div className=\"space-y-8 animate-in fade-in duration-500\">\n      {/* Header Skeleton */}\n      <div className=\"flex flex-col gap-2\">\n        <div className=\"h-8 w-64 bg-[var(--color-sys-bg-tertiary)]/20 rounded-xl animate-pulse\" />\n        <div className=\"h-4 w-96 bg-[var(--color-sys-bg-tertiary)]/10 rounded-lg animate-pulse\" />\n      </div>\n\n      {/* KPI Grid Skeleton */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {[1, 2, 3].map((i) => (\n          <div\n            key={i}\n            className=\"h-32 rounded-3xl bg-[var(--color-sys-bg-surface)] border border-[var(--color-sys-text-tertiary)]/5 shadow-sm p-6 space-y-4\"\n          >\n            <div className=\"flex justify-between items-start\">\n              <div className=\"h-4 w-24 bg-[var(--color-sys-bg-tertiary)]/20 rounded-md\" />\n              <div className=\"h-10 w-10 rounded-2xl bg-[var(--color-sys-bg-tertiary)]/10\" />\n            </div>\n            <div className=\"h-8 w-32 bg-[var(--color-sys-bg-tertiary)]/30 rounded-lg\" />\n          </div>\n        ))}\n      </div>\n\n      {/* Table Skeleton */}\n      <div className=\"space-y-4\">\n        <div className=\"h-10 w-full bg-[var(--color-sys-bg-tertiary)]/10 rounded-2xl\" />\n        <div className=\"rounded-3xl border border-[var(--color-sys-text-tertiary)]/5 overflow-hidden\">\n          {[1, 2, 3, 4, 5].map((i) => (\n            <div\n              key={i}\n              className=\"h-16 w-full border-b border-[var(--color-sys-text-tertiary)]/5 bg-[var(--color-sys-bg-surface)]/50 p-4 flex items-center gap-4\"\n            >\n              <div className=\"h-4 w-8 bg-[var(--color-sys-bg-tertiary)]/10 rounded-md\" />\n              <div className=\"h-4 w-1/4 bg-[var(--color-sys-bg-tertiary)]/20 rounded-md\" />\n              <div className=\"h-4 w-1/4 bg-[var(--color-sys-bg-tertiary)]/10 rounded-md\" />\n              <div className=\"h-4 w-1/4 bg-[var(--color-sys-bg-tertiary)]/10 rounded-md ml-auto\" />\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\po-notes\\page.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"X"},"fix":{"range":[111,114],"text":""},"desc":"Remove unused variable 'X'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":4,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":42},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":33,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":33,"endColumn":20,"suggestions":[{"fix":{"range":[1411,1459],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":53,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":53,"endColumn":22,"suggestions":[{"fix":{"range":[1950,1997],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":72,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":72,"endColumn":20,"suggestions":[{"fix":{"range":[2464,2513],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":122,"column":37,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":122,"endColumn":71},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":124,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":124,"endColumn":65},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":139,"column":27,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":139,"endColumn":74},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":148,"column":34,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":148,"endColumn":109},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":158,"column":34,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":158,"endColumn":60},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":173,"column":28,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":173,"endColumn":62},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":176,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":176,"endColumn":56}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useState, useCallback } from \"react\";\nimport { Plus, Edit2, Trash2, FileText, X, CheckSquare, Quote } from \"lucide-react\";\nimport { api, PONote } from \"@/lib/api\";\nimport { H3, Body, SmallText, Label } from \"@/components/design-system/organisms\";\nimport { Button } from \"@/components/design-system/organisms\";\nimport { Card } from \"@/components/design-system/organisms\";\nimport { Input } from \"@/components/design-system/organisms\";\nimport { Badge } from \"@/components/design-system/organisms\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport { Dialog } from \"@/components/design-system/molecules/Dialog\";\nimport { Flex, Stack, Grid, Box } from \"@/components/design-system/organisms\";\n\nexport default function PONotesPage() {\n  const [templates, setTemplates] = useState<PONote[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  const [editingId, setEditingId] = useState<number | null>(null);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [formData, setFormData] = useState({ title: \"\", content: \"\" });\n\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  const loadTemplates = useCallback(async () => {\n    try {\n      setLoading(true);\n      const data = await api.getPONotes();\n      setTemplates(data || []);\n    } catch (err) {\n      console.error(\"Failed to load templates:\", err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const handleSubmit = useCallback(\n    async (e: React.FormEvent) => {\n      e.preventDefault();\n      try {\n        if (editingId) {\n          await api.updatePONote(editingId.toString(), formData);\n        } else {\n          await api.createPONote(formData);\n        }\n        setFormData({ title: \"\", content: \"\" });\n        setEditingId(null);\n        setShowForm(false);\n        loadTemplates();\n      } catch (err) {\n        console.error(\"Failed to save template:\", err);\n      }\n    },\n    [editingId, formData, loadTemplates]\n  );\n\n  const handleEdit = useCallback((template: PONote) => {\n    setFormData({ title: template.title, content: template.content });\n    setEditingId(template.id);\n    setShowForm(true);\n  }, []);\n\n  const handleDelete = useCallback(async () => {\n    if (!deleteId) return;\n    try {\n      await api.deletePONote(deleteId.toString());\n      loadTemplates();\n      setDeleteId(null);\n    } catch (err) {\n      console.error(\"Failed to delete template:\", err);\n    }\n  }, [deleteId, loadTemplates]);\n\n  const actions = (\n    <Button\n      variant=\"default\"\n      onClick={() => {\n        setFormData({ title: \"\", content: \"\" });\n        setEditingId(null);\n        setShowForm(true);\n      }}\n      disabled={loading}\n    >\n      <Plus size={16} />\n      New Template\n    </Button>\n  );\n\n  return (\n    <DocumentTemplate\n      title=\"Document Templates\"\n      description=\"Reusable terms and conditions for purchase orders & challans\"\n      actions={actions}\n      className=\"space-y-6\"\n    >\n      <Stack gap={6}>\n        {/* Content Grid */}\n        <Grid cols=\"1\" className=\"md:grid-cols-2 lg:grid-cols-3\" gap={6}>\n          {loading ? (\n            Array.from({ length: 6 }).map((_, i) => (\n              <Card key={i} className=\"h-64 p-6 flex flex-col gap-4\">\n                <Flex align=\"center\" gap={3}>\n                  <div className=\"w-10 h-10 rounded-lg bg-slate-100 animate-pulse\" />\n                  <div className=\"h-4 w-32 bg-slate-100 rounded animate-pulse\" />\n                </Flex>\n                <div className=\"flex-1 bg-slate-50/50 rounded-lg border border-slate-100 animate-pulse\" />\n              </Card>\n            ))\n          ) : (\n            <>\n              {templates.map((template) => (\n                <Card\n                  key={template.id}\n                  className=\"flex flex-col h-full hover:shadow-lg transition-shadow animate-in fade-in zoom-in-95 duration-300\"\n                >\n                  <div className=\"p-6 flex-1 flex flex-col\">\n                    <Flex justify=\"between\" align=\"start\" className=\"mb-4\">\n                      <Flex align=\"center\" gap={3} className=\"flex-1\">\n                        <div className=\"w-10 h-10 bg-[#1A3D7C]/10 rounded-lg flex items-center justify-center shrink-0\">\n                          <FileText className=\"w-5 h-5 text-[#1A3D7C]\" />\n                        </div>\n                        <H3 className=\"text-[16px] line-clamp-1\">{template.title}</H3>\n                      </Flex>\n                      <Flex gap={1}>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleEdit(template)}\n                          title=\"Edit\"\n                        >\n                          <Edit2 size={14} />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setDeleteId(template.id)}\n                          className=\"text-[#DC2626] hover:text-[#991B1B]\"\n                          title=\"Delete\"\n                        >\n                          <Trash2 size={14} />\n                        </Button>\n                      </Flex>\n                    </Flex>\n\n                    <Box className=\"flex-1 bg-[#F9FAFB] rounded-lg p-4 border border-[#E5E7EB]\">\n                      <SmallText className=\"text-[#6B7280] leading-relaxed whitespace-pre-wrap line-clamp-6\">\n                        {template.content}\n                      </SmallText>\n                    </Box>\n\n                    <Flex\n                      align=\"center\"\n                      justify=\"between\"\n                      className=\"mt-4 pt-4 border-t border-[#E5E7EB]\"\n                    >\n                      <SmallText className=\"text-[#9CA3AF]\">\n                        Ver. {new Date(template.updated_at).getFullYear()}.\n                        {new Date(template.updated_at).getMonth() + 1}\n                      </SmallText>\n                      <Badge variant=\"success\">\n                        <CheckSquare size={12} /> Active\n                      </Badge>\n                    </Flex>\n                  </div>\n                </Card>\n              ))}\n\n              {templates.length === 0 && (\n                <Card className=\"text-center py-24 border-dashed border-[#E5E7EB] col-span-full\">\n                  <div className=\"w-16 h-16 bg-[#F9FAFB] rounded-full flex items-center justify-center mx-auto mb-4\">\n                    <Quote className=\"w-8 h-8 text-[#D1D5DB]\" />\n                  </div>\n                  <H3 className=\"mb-2\">No templates configured</H3>\n                  <Body className=\"text-[#6B7280] mb-6\">\n                    Standardize your document terms for faster processing.\n                  </Body>\n                  <Button onClick={() => setShowForm(true)} variant=\"default\">\n                    <Plus size={16} />\n                    Setup First Template\n                  </Button>\n                </Card>\n              )}\n            </>\n          )}\n        </Grid>\n      </Stack>\n\n      {/* Edit/Create Dialog */}\n      <Dialog\n        isOpen={showForm}\n        onClose={() => setShowForm(false)}\n        title={editingId ? \"Update Template\" : \"New Template\"}\n        maxWidth=\"max-w-xl\"\n        footer={\n          <Button type=\"button\" variant=\"default\" onClick={handleSubmit} className=\"w-full\">\n            {editingId ? \"Save Changes\" : \"Create Template\"}\n          </Button>\n        }\n      >\n        <Stack gap={4} className=\"py-4\">\n          <p className=\"text-sm text-slate-500 -mt-2\">\n            Configure standard terms for purchase orders\n          </p>\n          <Stack gap={2}>\n            <Label>Template Title</Label>\n            <Input\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              placeholder=\"e.g., Standard Warranty Clause\"\n              required\n              autoFocus\n            />\n          </Stack>\n\n          <Stack gap={2}>\n            <Label>Template Content</Label>\n            <textarea\n              value={formData.content}\n              onChange={(e) => setFormData({ ...formData, content: e.target.value })}\n              rows={10}\n              className=\"w-full px-3 py-2 border border-[#D1D5DB] rounded-md focus:outline-none focus:ring-2 focus:ring-[#1A3D7C] resize-none\"\n              placeholder=\"Enter documentation text...\"\n              required\n            />\n          </Stack>\n        </Stack>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog\n        isOpen={!!deleteId}\n        onClose={() => setDeleteId(null)}\n        title=\"Delete Template?\"\n        maxWidth=\"max-w-md\"\n        footer={\n          <div className=\"flex gap-3 w-full\">\n            <Button variant=\"ghost\" onClick={() => setDeleteId(null)} className=\"flex-1\">\n              Cancel\n            </Button>\n            <Button variant=\"destructive\" onClick={handleDelete} className=\"flex-1\">\n              Delete Forever\n            </Button>\n          </div>\n        }\n      >\n        <p className=\"mb-4 text-slate-500\">This action cannot be undone.</p>\n        <Body className=\"text-slate-600\">\n          Are you sure you want to permanently delete this template? Any new documents will no\n          longer be able to use this preset.\n        </Body>\n      </Dialog>\n    </DocumentTemplate>\n  );\n}\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\po\\[...id]\\page.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"ArrowLeft"},"fix":{"range":[157,167],"text":""},"desc":"Remove unused variable 'ArrowLeft'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ArrowLeft' is defined but never used.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'poRoute' is defined but never used.","line":26,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"poRoute"},"fix":{"range":[487,496],"text":""},"desc":"Remove unused variable 'poRoute'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'poRoute' is defined but never used.","line":26,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'H1' is defined but never used.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":5,"suggestions":[{"messageId":"removeVar","data":{"varName":"H1"},"fix":{"range":[776,782],"text":""},"desc":"Remove unused variable 'H1'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'H1' is defined but never used.","line":35,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":5},{"ruleId":"no-unused-vars","severity":1,"message":"'H3' is defined but never used.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":5,"suggestions":[{"messageId":"removeVar","data":{"varName":"H3"},"fix":{"range":[782,788],"text":""},"desc":"Remove unused variable 'H3'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'H3' is defined but never used.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":5},{"ruleId":"no-unused-vars","severity":1,"message":"'DetailField' is defined but never used.","line":45,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"DetailField"},"fix":{"range":[905,984],"text":""},"desc":"Remove unused variable 'DetailField'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DetailField' is defined but never used.","line":45,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":78,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[2138,2143],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is assigned a value but never used.","line":78,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":148,"column":5,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":148,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'handleDisableEdit' is assigned a value but never used.","line":200,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleDisableEdit"},"fix":{"range":[6208,6276],"text":""},"desc":"Remove unused variable 'handleDisableEdit'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleDisableEdit' is assigned a value but never used.","line":200,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":200,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'topActions' is assigned a value but never used.","line":208,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":208,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"topActions"},"fix":{"range":[6393,8552],"text":""},"desc":"Remove unused variable 'topActions'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'topActions' is assigned a value but never used.","line":208,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":208,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":216,"column":13,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":216,"endColumn":113},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":232,"column":13,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":232,"endColumn":238},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":284,"column":16,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":284,"endColumn":83},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":289,"column":13,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":289,"endColumn":228},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":325,"column":13,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":325,"endColumn":140},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":340,"column":11,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":340,"endColumn":115},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":347,"column":23,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":347,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":372,"column":11,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":372,"endColumn":138},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":374,"column":18,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":374,"endColumn":80},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":388,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":388,"endColumn":82},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":605,"column":26,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":605,"endColumn":107},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":670,"column":31,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":670,"endColumn":181},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":686,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":686,"endColumn":181},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":692,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":692,"endColumn":173},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":797,"column":31,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":797,"endColumn":211},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":801,"column":43,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":801,"endColumn":155},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":826,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":826,"endColumn":203},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":840,"column":37,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":840,"endColumn":160},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":847,"column":37,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":847,"endColumn":246},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":868,"column":47,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":868,"endColumn":129},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":874,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":874,"endColumn":135},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":887,"column":45,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":887,"endColumn":155},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":890,"column":55,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":890,"endColumn":152},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":897,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":897,"endColumn":135},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":913,"column":45,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":913,"endColumn":197},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":916,"column":49,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":916,"endColumn":131},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":923,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":923,"endColumn":135},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":926,"column":52,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":926,"endColumn":133},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":932,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":932,"endColumn":135},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":935,"column":52,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":935,"endColumn":143},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":946,"column":45,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":946,"endColumn":183},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":956,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":956,"endColumn":97},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":959,"column":48,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":959,"endColumn":104}],"suppressedMessages":[],"errorCount":42,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState, Suspense, useCallback } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport {\n  ArrowLeft,\n  Edit2,\n  Save,\n  X,\n  ChevronDown,\n  ChevronUp,\n  Plus,\n  FileText,\n  Calendar,\n  Info,\n  Landmark,\n  ShieldCheck,\n  Receipt,\n  FileDown,\n  Trash2,\n  Layers,\n} from \"lucide-react\";\n\nimport { api, API_BASE_URL } from \"@/lib/api\";\nimport { formatDate, formatIndianCurrency, cn } from \"@/lib/utils\";\nimport { normalizeId, poRoute, dcRoute, createDCRoute } from \"@/lib/routes\";\nimport { PODetail, POItem, PODelivery, SRVListItem } from \"@/types\";\n\n// Atomic Design Components\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport {\n  GlassContainer,\n  Button,\n  Badge,\n  H1,\n  H3,\n  Body,\n  SmallText,\n  Label,\n  Input,\n  Accounting,\n  Flex,\n  Box,\n} from \"@/components/design-system/organisms\";\nimport { DetailField } from \"@/components/design-system/molecules/DetailField\";\nimport {\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n} from \"@/components/design-system/molecules/Tabs\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport dynamic from \"next/dynamic\";\nimport { DetailSkeleton } from \"@/components/design-system/molecules/skeletons/DetailSkeleton\";\n\nconst DocumentJourney = dynamic(\n  () =>\n    import(\"@/components/design-system/molecules/DocumentJourney\").then(\n      (mod) => mod.DocumentJourney\n    ),\n  {\n    loading: () => <div className=\"h-6 w-48 bg-[var(--color-sys-bg-tertiary)] rounded-full animate-pulse\" />,\n    ssr: false,\n  }\n);\n\nfunction PODetailContent() {\n  const router = useRouter();\n  const params = useParams();\n  const poId = normalizeId(params?.id as string | string[] || \"\");\n  const [data, setData] = useState<PODetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [editMode, setEditMode] = useState(false);\n  const [expandedItems, setExpandedItems] = useState<Set<number>>(new Set());\n  const [hasDC, setHasDC] = useState(false);\n  const [dcId, setDCId] = useState<string | null>(null);\n  const [srvs, setSrvs] = useState<SRVListItem[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  // Restore tab state from v2 blueprint\n  const [activeTab, setActiveTab] = useState(\"basic\");\n\n  useEffect(() => {\n    if (!poId) return;\n    const loadData = async () => {\n      try {\n        const [poData, dcCheck, srvData] = await Promise.all([\n          api.getPODetail(poId),\n          api.checkPOHasDC(poId).catch(() => null),\n          api.listSRVs(poId).catch(() => []),\n        ]);\n\n        setData(poData);\n        if (poData.items)\n          setExpandedItems(new Set(poData.items.map((item: POItem) => item.po_item_no)));\n\n        if (dcCheck?.has_dc) {\n          setHasDC(true);\n          setDCId(dcCheck.dc_id || null);\n        }\n        // Fix: Ensure we handle potential type mismatch if API returns strictly SRVListItem[]\n        // but Types expects extra fields. For now, we cast or map if necessary.\n        setSrvs((srvData || []) as SRVListItem[]);\n      } catch (err: any) {\n        setError(err.message || \"Traceback failure in record retrieval\");\n      } finally {\n        setLoading(false);\n      }\n    };\n    loadData();\n  }, [poId]);\n\n  const handleSave = useCallback(async () => {\n    if (!data || !data.header) return;\n    setLoading(true);\n    try {\n      await api.updatePO(data.header.po_number, data.header, data.items);\n      setEditMode(false);\n      const poData = await api.getPODetail(poId);\n      setData(poData);\n    } catch (err: any) {\n      setError(err.message || \"Failed to sync changes\");\n    } finally {\n      setLoading(false);\n    }\n  }, [data, poId]);\n\n  const addItem = useCallback(() => {\n    if (!data || !data.items) return;\n    const maxItemNo = Math.max(...data.items.map((i: POItem) => i.po_item_no || 0), 0);\n    const newItem = {\n      po_item_no: maxItemNo + 1,\n      material_code: \"\",\n      material_description: \"NEW PROCUREMENT ITEM\",\n      drg_no: \"\",\n      unit: \"NOS\",\n      ordered_quantity: 0,\n      po_rate: 0,\n      item_value: 0,\n      delivered_quantity: 0,\n      deliveries: [],\n    };\n    setData({ ...data, items: [...data.items, newItem] });\n    setExpandedItems(new Set([...Array.from(expandedItems), maxItemNo + 1]));\n  }, [data, expandedItems]);\n\n  const toggleItem = useCallback((itemNo: number) => {\n    const s = new Set(expandedItems);\n    s.has(itemNo) ? s.delete(itemNo) : s.add(itemNo);\n    setExpandedItems(s);\n  }, [expandedItems]);\n\n  const updateHeader = (field: string, value: any) => {\n    if (!data) return;\n    setData({\n      ...data,\n      header: { ...data.header, [field]: value },\n    });\n  };\n\n  const updateItem = (index: number, field: string, value: any) => {\n    if (!data || !data.items) return;\n    const newItems = [...data.items];\n    newItems[index] = { ...newItems[index], [field]: value };\n    if (field === \"po_rate\" || field === \"ordered_quantity\") {\n      newItems[index].item_value =\n        (newItems[index].ordered_quantity || 0) * (newItems[index].po_rate || 0);\n    }\n    setData({ ...data, items: newItems });\n  };\n\n  const addDelivery = (itemIdx: number) => {\n    if (!data || !data.items) return;\n    const newItems = [...data.items];\n    const item = newItems[itemIdx];\n    const maxLotNo = Math.max(...(item.deliveries?.map((d: PODelivery) => d.lot_no || 0) || []), 0);\n    const newLot = {\n      lot_no: maxLotNo + 1,\n      delivered_quantity: 0,\n      dely_date: new Date().toISOString().split(\"T\")[0],\n    };\n    newItems[itemIdx].deliveries = [...(item.deliveries || []), newLot];\n    setData({ ...data, items: newItems });\n  };\n\n  const removeDelivery = (itemIdx: number, deliveryIdx: number) => {\n    if (!data || !data.items) return;\n    const newItems = [...data.items];\n    newItems[itemIdx].deliveries = newItems[itemIdx].deliveries.filter((_, i) => i !== deliveryIdx);\n    setData({ ...data, items: newItems });\n  };\n\n\n  const removeItem = (index: number) => {\n    if (!data || !data.items) return;\n    const newItems = data.items.filter((_, i) => i !== index);\n    setData({ ...data, items: newItems });\n  };\n\n  const handleEnableEdit = useCallback(() => setEditMode(true), []);\n  const handleDisableEdit = useCallback(() => setEditMode(false), []);\n\n  if (loading || !data || !data.header) {\n    return <DetailSkeleton />;\n  }\n\n  const { header, items } = data;\n\n  const topActions = (\n    <div className=\"flex items-center gap-2.5\">\n      {editMode ? (\n        <>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setEditMode(false)}\n            className=\"text-[var(--color-sys-status-error)] border-[var(--color-sys-status-error)]/20 shadow-sm\"\n          >\n            <X className=\"w-3.5 h-3.5 mr-2\" />\n            Discard\n          </Button>\n          <Button variant=\"default\" size=\"sm\" onClick={handleSave}>\n            <Save className=\"w-3.5 h-3.5 mr-2\" />\n            SAVE CHANGES\n          </Button>\n        </>\n      ) : (\n        <>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            asChild\n            className=\"text-[var(--color-sys-status-success)] border-[var(--color-sys-status-success)]/20 bg-[var(--color-sys-status-success)]/10 hover:bg-[var(--color-sys-status-success)]/20 hover:text-[var(--color-sys-status-success)]\"\n          >\n            <a\n              href={`${api.baseUrl}/api/po/${header.po_number}/download`}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              <FileDown className=\"w-3.5 h-3.5 mr-2\" />\n              EXCEL\n            </a>\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() =>\n              hasDC && dcId\n                ? router.push(dcRoute(dcId))\n                : router.push(createDCRoute(header.po_number))\n            }\n            className={cn(\n              \"border-[var(--color-sys-text-tertiary)]/20\",\n              hasDC\n                ? \"bg-[var(--color-sys-status-success)]/10 text-[var(--color-sys-status-success)] shadow-sm border-[var(--color-sys-status-success)]/20\"\n                : \"text-[var(--color-sys-text-secondary)]\"\n            )}\n          >\n            <FileText className=\"w-3.5 h-3.5 mr-2\" />\n            {hasDC ? \"VIEW DC\" : \"GENERATE DC\"}\n          </Button>\n          <Button variant=\"default\" size=\"sm\" onClick={handleEnableEdit}>\n            <Edit2 className=\"w-3.5 h-3.5 mr-2\" />\n            MODIFY\n          </Button>\n        </>\n      )}\n    </div>\n  );\n\n  // Using Atomic Components for Fields - Unified for Zero Layout Shift\n  const Field = ({\n    label,\n    value,\n    field,\n    readonly = false,\n  }: {\n    label: string;\n    value: any;\n    field?: string;\n    readonly?: boolean;\n  }) => {\n    return (\n      <div className=\"min-h-[44px] flex flex-col justify-center\">\n        <Label className=\"mb-1.5 font-bold text-[var(--color-sys-text-secondary)]\">{label}</Label>\n        {editMode && field && !readonly ? (\n          <Input\n            value={value ?? \"\"}\n            onChange={(e) => updateHeader(field, e.target.value)}\n            className=\"h-7 text-body px-2 py-1 border-none bg-[var(--color-sys-bg-tertiary)]/50 focus:bg-[var(--color-sys-bg-primary)] transition-all shadow-none focus:shadow-sm font-medium text-[var(--color-sys-text-primary)]\"\n          />\n        ) : (\n          <Body\n            className=\"font-medium text-sys-primary leading-tight py-1 truncate\"\n            title={value?.toString()}\n          >\n            {value || (\n              <span className=\"text-sys-tertiary font-normal italic opacity-60 uppercase tracking-tighter text-label\">\n                Empty\n              </span>\n            )}\n          </Body>\n        )}\n      </div>\n    );\n  };\n\n  // ≡ƒÄ¿ VISUAL UPGRADE: Actions (Moved from fixed bar to standard top actions for compliance)\n  const renderActions = () => {\n    if (editMode) {\n      return (\n        <Flex align=\"center\" gap={3}>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setEditMode(false)}\n            className=\"text-sys-secondary hover:bg-[var(--color-sys-bg-tertiary)]/10 text-small\"\n          >\n            <X className=\"w-4 h-4 mr-2\" />\n            DISCARD\n          </Button>\n          <Button\n            variant=\"default\"\n            size=\"sm\"\n            onClick={handleSave}\n            className=\"bg-[var(--color-sys-brand-primary)] hover:brightness-110 text-[var(--color-sys-text-on-brand)] shadow-sm text-small\"\n          >\n            <Save className=\"w-4 h-4 mr-2\" />\n            SAVE CHANGES\n          </Button>\n        </Flex>\n      );\n    }\n\n    return (\n      <Flex align=\"center\" gap={3}>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          asChild\n          className=\"text-[var(--color-sys-text-secondary)] hover:bg-[var(--color-sys-bg-tertiary)]/10 text-small\"\n        >\n          <a\n            href={`${API_BASE_URL}/api/po/${header.po_number}/download`}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            <FileDown className=\"w-4 h-4 mr-2 text-[var(--color-sys-brand-primary)]\" />\n            EXCEL\n          </a>\n        </Button>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() =>\n            hasDC && dcId\n              ? router.push(dcRoute(dcId))\n              : router.push(createDCRoute(header.po_number))\n          }\n          className={cn(\n            \"text-[var(--color-sys-text-secondary)] hover:bg-[var(--color-sys-bg-tertiary)]/10 text-small\",\n            hasDC && \"text-[var(--color-sys-status-success)]\"\n          )}\n        >\n          <FileText className=\"w-4 h-4 mr-2\" />\n          {hasDC ? \"VIEW DC\" : \"GENERATE DC\"}\n        </Button>\n        <Box className=\"w-[1px] h-6 bg-[var(--color-sys-text-tertiary)]/10 mx-1\" />\n        <Button\n          variant=\"default\"\n          size=\"sm\"\n          onClick={handleEnableEdit}\n          className=\"bg-[var(--color-sys-brand-primary)] text-[var(--color-sys-text-on-brand)] hover:brightness-110 shadow-lg text-small\"\n        >\n          <Edit2 className=\"w-4 h-4 mr-2 text-[var(--color-sys-text-on-brand)]\" />\n          MODIFY RECORD\n        </Button>\n      </Flex>\n    );\n  };\n\n  return (\n    <DocumentTemplate\n      title={`PO #${header.po_number}`}\n      description={`${header.supplier_name} ΓÇó ${formatDate(header.po_date)}`}\n      actions={renderActions()}\n      onBack={() => router.back()}\n      layoutId={`po-title-${header.po_number}`}\n      icon={<FileText size={20} className=\"text-[var(--color-sys-brand-primary)]\" />}\n      iconLayoutId={`po-icon-${header.po_number}`}\n      status={header.po_status}\n    >\n      <div className=\"space-y-6\">\n        {/* Document Journey */}\n        <DocumentJourney currentStage=\"PO\" className=\"mb-2\" />\n\n        {/* V2 Layout: Comprehensive Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"mb-4 bg-transparent p-0 border-b border-[var(--color-sys-text-tertiary)]/10 w-full justify-start rounded-none gap-6\">\n            <TabsTrigger value=\"basic\">\n              <Info className=\"w-3.5 h-3.5 mr-1.5\" />\n              Basic\n            </TabsTrigger>\n            <TabsTrigger value=\"references\">\n              <FileText className=\"w-3.5 h-3.5 mr-1.5\" />\n              Refs\n            </TabsTrigger>\n            <TabsTrigger value=\"financial\">\n              <Landmark className=\"w-3.5 h-3.5 mr-1.5\" />\n              Finance\n            </TabsTrigger>\n            <TabsTrigger value=\"issuer\">\n              <ShieldCheck className=\"w-3.5 h-3.5 mr-1.5\" />\n              Issuer\n            </TabsTrigger>\n            <TabsTrigger value=\"srvs\">\n              <Receipt className=\"w-3.5 h-3.5 mr-1.5\" />\n              SRVs ({srvs.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={activeTab}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.15 }}\n            >\n              <GlassContainer className=\"p-6 min-h-[180px] border-none shadow-sm mt-0 relative top-[-1px]\">\n                <TabsContent value=\"basic\" className=\"m-0\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-x-8 gap-y-4\">\n                    <Field label=\"PO Number\" value={header.po_number} field=\"po_number\" readonly />\n                    <Field\n                      label=\"PO Date\"\n                      value={formatDate(header.po_date)}\n                      field=\"po_date\"\n                      readonly\n                    />\n                    <Field\n                      label=\"Supplier Name\"\n                      value={header.supplier_name}\n                      field=\"supplier_name\"\n                    />\n                    <Field\n                      label=\"Supplier Code\"\n                      value={header.supplier_code}\n                      field=\"supplier_code\"\n                    />\n                    <Field label=\"Phone\" value={header.supplier_phone} field=\"supplier_phone\" />\n                    <Field label=\"Fax\" value={header.supplier_fax} field=\"supplier_fax\" />\n                    <Field label=\"Email\" value={header.supplier_email} field=\"supplier_email\" />\n                    <Field\n                      label=\"Dept No (DVN)\"\n                      value={header.department_no}\n                      field=\"department_no\"\n                    />\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"references\" className=\"m-0\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-x-8 gap-y-4\">\n                    <Field label=\"Enquiry No\" value={header.enquiry_no} field=\"enquiry_no\" />\n                    <Field\n                      label=\"Enquiry Date\"\n                      value={formatDate(header.enquiry_date)}\n                      field=\"enquiry_date\"\n                    />\n                    <Field\n                      label=\"Quotation Ref\"\n                      value={header.quotation_ref}\n                      field=\"quotation_ref\"\n                    />\n                    <Field\n                      label=\"Quotation Date\"\n                      value={formatDate(header.quotation_date)}\n                      field=\"quotation_date\"\n                    />\n                    <Field label=\"RC No\" value={header.rc_no} field=\"rc_no\" />\n                    <Field label=\"Order Type\" value={header.order_type} field=\"order_type\" />\n                    <Field label=\"PO Status\" value={header.po_status} field=\"po_status\" />\n                    <Field label=\"Amd No\" value={header.amend_no} field=\"amend_no\" />\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"financial\" className=\"m-0\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-x-8 gap-y-4\">\n                    <Field\n                      label=\"PO Value\"\n                      value={formatIndianCurrency(header.po_value)}\n                      field=\"po_value\"\n                    />\n                    <Field\n                      label=\"FOB Value\"\n                      value={formatIndianCurrency(header.fob_value)}\n                      field=\"fob_value\"\n                    />\n                    <Field\n                      label=\"Net Value\"\n                      value={formatIndianCurrency(header.net_po_value)}\n                      field=\"net_po_value\"\n                    />\n                    <Field label=\"TIN No\" value={header.tin_no} field=\"tin_no\" />\n                    <Field label=\"ECC No\" value={header.ecc_no} field=\"ecc_no\" />\n                    <Field label=\"MPCT No\" value={header.mpct_no} field=\"mpct_no\" />\n                    <Field label=\"Currency\" value={header.currency} field=\"currency\" />\n                    <Field label=\"Ex Rate\" value={header.ex_rate} field=\"ex_rate\" />\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"issuer\" className=\"m-0\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-x-8 gap-y-4\">\n                    <Field\n                      label=\"Inspection By\"\n                      value={header.inspection_by}\n                      field=\"inspection_by\"\n                    />\n                    <Field label=\"Issuer Name\" value={header.issuer_name} field=\"issuer_name\" />\n                    <Field\n                      label=\"Designation\"\n                      value={header.issuer_designation}\n                      field=\"issuer_designation\"\n                    />\n                    <Field label=\"Issuer Phone\" value={header.issuer_phone} field=\"issuer_phone\" />\n                    {/* Truncated Remarks Section to Save a Row */}\n                    <div className=\"col-span-2 md:col-span-4 mt-2\">\n                      <div className=\"flex flex-col\">\n                        <Label className=\"mb-1 font-bold text-sys-secondary\">\n                          Remarks\n                        </Label>\n                        {editMode ? (\n                          <input\n                            value={header.remarks || \"\"}\n                            onChange={(e) => updateHeader(\"remarks\", e.target.value)}\n                            className=\"w-full h-8 px-2 text-body border-none bg-[var(--color-sys-bg-tertiary)]/50 rounded focus:bg-[var(--color-sys-bg-primary)] transition-all shadow-none font-medium text-sys-primary\"\n                            placeholder=\"Enter remarks...\"\n                          />\n                        ) : (\n                          <div\n                            className=\"text-body text-sys-primary font-normal line-clamp-1 italic px-0.5 opacity-90\"\n                            title={header.remarks || \"\"}\n                          >\n                            {header.remarks || \"No remarks provided.\"}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"srvs\" className=\"m-0\">\n                  {srvs.length > 0 ? (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                      {srvs.map((srv) => (\n                        <div\n                          key={srv.srv_number}\n                          className=\"p-4 rounded-xl shadow-sm bg-[var(--color-sys-bg-tertiary)]/10 hover:bg-[var(--color-sys-brand-primary)]/[0.03] hover:shadow-md transition-all duration-300 group cursor-pointer border border-[var(--color-sys-text-tertiary)]/10\"\n                          onClick={() => router.push(`/srv/${srv.srv_number}`)}\n                        >\n                          <div className=\"flex justify-between items-start mb-3\">\n                            <div className=\"space-y-0.5\">\n                              <Label className=\"font-bold text-sys-primary group-hover:text-sys-brand cursor-pointer\">\n                                SRV-{srv.srv_number}\n                              </Label>\n                              <SmallText className=\"font-medium text-sys-tertiary flex items-center gap-1 uppercase tracking-tighter\">\n                                <Calendar className=\"w-2.5 h-2.5\" />\n                                {formatDate(srv.srv_date)}\n                              </SmallText>\n                            </div>\n                            <div className=\"flex flex-col items-end gap-1.5\">\n                              <div className=\"w-6 h-6 rounded-lg bg-[var(--color-sys-brand-primary)]/10 flex items-center justify-center text-sys-brand shadow-sm border border-[var(--color-sys-brand-primary)]/20\">\n                                <Receipt className=\"w-3 h-3\" />\n                              </div>\n                              {srv.invoice_numbers && (\n                                <Badge\n                                  variant=\"default\"\n                                  className=\"text-h4 py-0 px-1.5 h-5 font-bold\"\n                                >\n                                  INV: {srv.invoice_numbers.split(\",\")[0]}\n                                </Badge>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"grid grid-cols-2 pt-2 border-t border-[var(--color-sys-text-tertiary)]/10 gap-2\">\n                            <div>\n                              <div className=\"text-h4 font-bold text-sys-success uppercase tracking-widest leading-tight\">\n                                Accepted\n                              </div>\n                              <div className=\"text-small font-bold text-sys-primary\">\n                                <Accounting>{srv.total_accepted_qty || 0}</Accounting>\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-h4 font-bold text-sys-error uppercase tracking-widest leading-tight\">\n                                Rejected\n                              </div>\n                              <div className=\"text-small font-bold text-sys-primary\">\n                                <Accounting>{srv.total_rejected_qty || 0}</Accounting>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-6 text-[var(--color-sys-text-tertiary)] text-xs italic\">\n                      No linked SRVs found.\n                    </div>\n                  )}\n                </TabsContent>\n              </GlassContainer>\n            </motion.div>\n          </AnimatePresence>\n        </Tabs>\n\n        {/* Items & Deliveries - Custom Table matching Atomic Vibe + V2 Layout */}\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Label className=\"m-0 text-body font-black text-sys-secondary\">\n                Bill of Materials\n              </Label>\n            </div>\n            {editMode && (\n              <Button\n                size=\"sm\"\n                onClick={addItem}\n                variant=\"ghost\"\n                className=\"h-8 text-small bg-[var(--color-sys-bg-tertiary)] text-sys-primary hover:bg-[var(--color-sys-bg-secondary)] font-bold\"\n              >\n                <Plus className=\"w-3.5 h-3.5 mr-1.5\" />\n                ADD ITEM\n              </Button>\n            )}\n          </div>\n\n          <div className=\"overflow-hidden rounded-2xl bg-[var(--color-sys-bg-primary)] shadow-xl shadow-[var(--color-sys-brand-primary)]/5 border-none\">\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-left\">\n                <thead className=\"bg-[var(--color-sys-bg-tertiary)]/50\">\n                  <tr>\n                    <th className=\"py-2.5 px-4 table-header-text text-center w-12\">#</th>\n                    <th className=\"py-2.5 px-4 table-header-text text-left w-32\">Code</th>\n                    <th className=\"py-2.5 px-4 table-header-text text-left\">Description</th>\n                    <th className=\"py-2.5 px-4 table-header-text text-left w-20\">Unit</th>\n                    <th className=\"py-2.5 px-4 table-header-text text-right w-28\">Rate</th>\n                    <th className=\"py-2.5 px-2 table-header-text text-right w-32\">Ord</th>\n                    <th className=\"py-2.5 px-2 table-header-text text-right w-32\">Dlv</th>\n                    <th className=\"py-2.5 px-2 table-header-text text-right w-32\">Bal</th>\n                    <th className=\"py-2.5 px-2 table-header-text text-right w-32\">Rec</th>\n                    <th className=\"py-2.5 px-4 w-12\"></th>\n                  </tr>\n                </thead>\n                <tbody className=\"min-h-[200px]\">\n                  {items.map((item, idx) => (\n                    <React.Fragment key={item.po_item_no}>\n                      <tr\n                        className={cn(\n                          \"hover:bg-[var(--color-sys-bg-secondary)] transition-colors group\",\n                          expandedItems.has(item.po_item_no) ? \"bg-[var(--color-sys-bg-secondary)]/50\" : \"\"\n                        )}\n                      >\n                        <td className=\"py-2 px-4 text-center align-top pt-3.5 italic table-cell-text\">\n                          {idx + 1}\n                        </td>\n                        <td className=\"py-2 px-4 align-top pt-2.5\">\n                          {editMode ? (\n                            <Input\n                              value={item.material_code}\n                              onChange={(e) => updateItem(idx, \"material_code\", e.target.value)}\n                              className=\"h-7 w-full px-1.5 py-1 border-none bg-[var(--color-sys-bg-tertiary)]/50 font-medium text-[var(--color-sys-text-primary)] table-cell-number\"\n                            />\n                          ) : (\n                            <Accounting className=\"tracking-tighter table-cell-number\">\n                              {item.material_code}\n                            </Accounting>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-4 align-top pt-2.5\">\n                          {editMode ? (\n                            <div className=\"space-y-1\">\n                              <Input\n                                value={item.material_description}\n                                onChange={(e) =>\n                                  updateItem(idx, \"material_description\", e.target.value)\n                                }\n                                className=\"h-7 w-full px-1.5 py-1 border-none bg-[var(--color-sys-bg-tertiary)]/50 font-medium text-[var(--color-sys-text-primary)] table-cell-text\"\n                              />\n                              <Input\n                                value={item.drg_no}\n                                onChange={(e) => updateItem(idx, \"drg_no\", e.target.value)}\n                                placeholder=\"Drawing\"\n                                className=\"h-6 text-small w-32 px-1.5 py-0.5 border-none bg-[var(--color-sys-bg-tertiary)] font-medium text-[var(--color-sys-text-primary)]\"\n                              />\n                            </div>\n                          ) : (\n                            <div className=\"space-y-0.5\">\n                              <div\n                                className=\"font-medium leading-tight truncate max-w-[400px] table-cell-text\"\n                                title={item.material_description}\n                              >\n                                {item.material_description}\n                              </div>\n                              {item.drg_no && (\n                                <div className=\"text-h4 font-medium text-sys-brand uppercase tracking-tight\">\n                                  DRG: {item.drg_no}\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-4 align-top pt-2.5\">\n                          {editMode ? (\n                            <Input\n                              value={item.unit}\n                              onChange={(e) => updateItem(idx, \"unit\", e.target.value)}\n                              className=\"h-7 text-body w-14 px-1 py-1 border-none bg-[var(--color-sys-bg-tertiary)]/50 font-medium text-sys-primary\"\n                            />\n                          ) : (\n                            <SmallText className=\"text-sys-secondary uppercase font-bold\">\n                              {item.unit}\n                            </SmallText>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-4 text-right align-top pt-3\">\n                          {editMode ? (\n                            <Input\n                              type=\"number\"\n                              variant=\"ghost\"\n                              value={item.po_rate}\n                              onChange={(e) =>\n                                updateItem(idx, \"po_rate\", parseFloat(e.target.value))\n                              }\n                              className=\"h-7 text-body text-right w-full px-1.5 py-1 font-medium text-sys-primary focus:bg-[var(--color-sys-bg-tertiary)] transition-colors\"\n                            />\n                          ) : (\n                            <div className=\"h-7 px-1.5 py-1 flex items-center justify-end\">\n                              <Accounting className=\"tracking-tighter table-cell-number font-mono text-right block\">\n                                {formatIndianCurrency(item.po_rate)}\n                              </Accounting>\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-2 text-right align-top pt-3\">\n                          {editMode ? (\n                            <Input\n                              type=\"number\"\n                              variant=\"ghost\"\n                              value={item.ordered_quantity}\n                              onChange={(e) =>\n                                updateItem(idx, \"ordered_quantity\", parseFloat(e.target.value))\n                              }\n                              className=\"h-7 text-body text-right w-full px-1 py-1 font-medium text-sys-primary focus:bg-[var(--color-sys-bg-tertiary)] transition-colors\"\n                            />\n                          ) : (\n                            <div className=\"h-7 px-1 py-1 flex items-center justify-end\">\n                              <Accounting className=\"tracking-tighter table-cell-number text-right block font-mono\">\n                                {item.ordered_quantity}\n                              </Accounting>\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-2 text-right align-top pt-3\">\n                          {editMode ? (\n                            <Input\n                              type=\"number\"\n                              variant=\"ghost\"\n                              value={item.delivered_quantity}\n                              onChange={(e) =>\n                                updateItem(idx, \"delivered_quantity\", parseFloat(e.target.value))\n                              }\n                              className=\"h-7 text-body text-right w-full px-1 py-1 font-mono font-medium text-sys-brand focus:bg-[var(--color-sys-brand-primary)]/10 transition-colors\"\n                            />\n                          ) : (\n                            <div className=\"h-7 px-1 py-1 flex items-center justify-end\">\n                              <Accounting className=\"text-sys-brand tracking-tighter table-cell-number text-right block font-mono\">\n                                {item.delivered_quantity}\n                              </Accounting>\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-2 text-right align-top pt-3\">\n                          <div className=\"h-7 px-1 py-1 flex items-center justify-end\">\n                            <Accounting className=\"tracking-tighter table-cell-number text-right block font-mono\">\n                              {(item.ordered_quantity || 0) - (item.received_quantity || 0)}\n                            </Accounting>\n                          </div>\n                        </td>\n                        <td className=\"py-2 px-2 text-right align-top pt-3\">\n                          {editMode ? (\n                            <Input\n                              type=\"number\"\n                              variant=\"ghost\"\n                              value={item.received_quantity}\n                              onChange={(e) =>\n                                updateItem(idx, \"received_quantity\", parseFloat(e.target.value))\n                              }\n                              className=\"h-7 text-[13px] text-right w-full px-1 py-1 font-mono font-medium text-[var(--color-sys-status-success)] focus:bg-[var(--color-sys-status-success)]/10 transition-colors\"\n                            />\n                          ) : (\n                            <div className=\"h-7 px-1 py-1 flex items-center justify-end\">\n                              <Accounting className=\"text-[var(--color-sys-status-success)] tracking-tighter table-cell-number text-right block font-mono\">\n                                {item.received_quantity}\n                              </Accounting>\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-2 px-4 align-top pt-2\">\n                          <div className=\"flex flex-col gap-1 items-center\">\n                            <button\n                              onClick={() => toggleItem(item.po_item_no)}\n                              className={cn(\n                                \"p-1.5 rounded-md transition-all text-[var(--color-sys-text-tertiary)] hover:text-[var(--color-sys-text-primary)]\",\n                                expandedItems.has(item.po_item_no) &&\n                                \"text-[var(--color-sys-brand-primary)] bg-[var(--color-sys-brand-primary)]/10\"\n                              )}\n                            >\n                              {expandedItems.has(item.po_item_no) ? (\n                                <ChevronUp className=\"w-4 h-4\" />\n                              ) : (\n                                <ChevronDown className=\"w-4 h-4\" />\n                              )}\n                            </button>\n                            {editMode && (\n                              <button\n                                onClick={() => removeItem(idx)}\n                                className=\"p-1.5 rounded-md text-[var(--color-sys-status-error)]/60 hover:text-[var(--color-sys-status-error)] hover:bg-[var(--color-sys-status-error)]/10 transition-all\"\n                              >\n                                <Trash2 className=\"w-4 h-4\" />\n                              </button>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                      {expandedItems.has(item.po_item_no) && (\n                        <tr className=\"bg-[var(--color-sys-bg-tertiary)]/5\">\n                          <td colSpan={10} className=\"p-0\">\n                            <div className=\"pb-6 pt-2 pl-12 relative\">\n                              <div className=\"absolute left-[34px] top-0 bottom-6 w-px bg-[var(--color-sys-text-tertiary)]/20\" />\n                              <div className=\"flex items-center justify-between mb-3 border-none pb-2\">\n                                <h4 className=\"text-[10px] font-bold text-[var(--color-sys-text-secondary)] uppercase tracking-[0.2em] flex items-center gap-2\">\n                                  <Layers size={12} />\n                                  Delivery Lots & Schedules\n                                </h4>\n                                {editMode && (\n                                  <button\n                                    onClick={() => addDelivery(idx)}\n                                    className=\"text-[10px] font-bold text-[var(--color-sys-brand-primary)] hover:brightness-110 transition-all uppercase tracking-tight flex items-center bg-[var(--color-sys-brand-primary)]/5 px-2 py-1 rounded-md\"\n                                  >\n                                    <Plus className=\"w-3 h-3 mr-1\" />\n                                    Add Lot\n                                  </button>\n                                )}\n                              </div>\n\n                              <div className=\"space-y-1 relative ml-2\">\n                                {/* Vertical Guide Line */}\n                                <div className=\"absolute left-[-14px] top-0 bottom-4 w-px bg-[var(--color-sys-text-tertiary)]/20\" />\n                                {item.deliveries && item.deliveries.length > 0 ? (\n                                  item.deliveries.map((d, dIdx) => (\n                                    <div\n                                      key={dIdx}\n                                      className=\"flex items-center gap-8 py-2 px-4 rounded-lg hover:bg-[var(--color-sys-bg-tertiary)]/10 transition-colors group/lot relative\"\n                                    >\n                                      {/* Horizontal Connector */}\n                                      <div className=\"absolute left-[-14px] top-1/2 w-3 h-px bg-[var(--color-sys-text-tertiary)]/20\" />\n\n                                      <div className=\"flex items-center gap-3 min-w-[60px]\">\n                                        <span className=\"text-[11px] font-black text-[var(--color-sys-brand-primary)] font-mono\">\n                                          L{d.lot_no}\n                                        </span>\n                                      </div>\n\n                                      <div className=\"flex items-center gap-2 min-w-[120px] justify-end\">\n                                        <Label className=\"mb-0 text-[9px] text-[var(--color-sys-text-tertiary)] uppercase font-medium\">\n                                          Qty\n                                        </Label>\n                                        {editMode ? (\n                                          <Input\n                                            type=\"number\"\n                                            value={d.delivered_quantity}\n                                            onChange={(e) => {\n                                              const n = [...items];\n                                              n[idx].deliveries[dIdx].delivered_quantity =\n                                                parseFloat(e.target.value);\n                                              setData({ ...data, items: n });\n                                            }}\n                                            className=\"h-7 w-20 text-right bg-[var(--color-sys-bg-secondary)] border-none text-[11px] font-bold font-mono\"\n                                          />\n                                        ) : (\n                                          <Accounting className=\"text-[11px] font-bold text-[var(--color-sys-text-primary)] font-mono text-right block\">\n                                            {d.delivered_quantity}\n                                          </Accounting>\n                                        )}\n                                      </div>\n\n                                      <div className=\"flex items-center gap-2 min-w-[150px]\">\n                                        <Label className=\"mb-0 text-[9px] text-[var(--color-sys-text-tertiary)] uppercase font-medium\">\n                                          Date\n                                        </Label>\n                                        {editMode ? (\n                                          <input\n                                            type=\"date\"\n                                            value={\n                                              d.dely_date\n                                                ? new Date(d.dely_date).toISOString().split(\"T\")[0]\n                                                : \"\"\n                                            }\n                                            onChange={(e) => {\n                                              const n = [...items];\n                                              n[idx].deliveries[dIdx].dely_date = e.target.value;\n                                              setData({ ...data, items: n });\n                                            }}\n                                            className=\"h-7 w-28 text-[11px] bg-[var(--color-sys-bg-secondary)] rounded px-2 border-none outline-none text-[var(--color-sys-text-primary)] font-bold\"\n                                          />\n                                        ) : (\n                                          <Body className=\"text-[11px] font-bold text-[var(--color-sys-text-secondary)] font-mono\">\n                                            {formatDate(d.dely_date)}\n                                          </Body>\n                                        )}\n                                      </div>\n\n                                      <div className=\"flex items-center gap-2 min-w-[150px]\">\n                                        <Label className=\"mb-0 text-[9px] text-[var(--color-sys-text-tertiary)] uppercase font-medium\">\n                                          Entry By\n                                        </Label>\n                                        <SmallText className=\"text-[10px] font-bold text-[var(--color-sys-text-tertiary)] font-mono\">\n                                          {formatDate(d.entry_allow_date)}\n                                        </SmallText>\n                                      </div>\n\n                                      <div className=\"flex items-center gap-2 min-w-[80px]\">\n                                        <Label className=\"mb-0 text-[9px] text-[var(--color-sys-text-tertiary)] uppercase font-medium\">\n                                          Dest\n                                        </Label>\n                                        <SmallText className=\"text-[10px] font-bold text-[var(--color-sys-text-tertiary)] font-mono uppercase\">\n                                          {d.dest_code || \"-\"}\n                                        </SmallText>\n                                      </div>\n\n                                      {editMode && (\n                                        <div className=\"ml-auto\">\n                                          <Button\n                                            variant=\"ghost\"\n                                            size=\"sm\"\n                                            onClick={() => removeDelivery(idx, dIdx)}\n                                            className=\"text-[var(--color-sys-status-error)]/40 hover:text-[var(--color-sys-status-error)] hover:bg-[var(--color-sys-status-error)]/10\"\n                                          >\n                                            <Trash2 className=\"w-3.5 h-3.5\" />\n                                          </Button>\n                                        </div>\n                                      )}\n                                    </div>\n                                  ))\n                                ) : (\n                                  <div className=\"flex items-center gap-3 py-4 pl-12\">\n                                    <SmallText className=\"text-[var(--color-sys-text-tertiary)]\">\n                                      Γöö\n                                    </SmallText>\n                                    <SmallText className=\"italic text-[var(--color-sys-text-tertiary)]\">\n                                      No delivery lots defined for this item\n                                    </SmallText>\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                          </td>\n                        </tr>\n                      )}\n                    </React.Fragment>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n      {/* Removed fixed floating actions bar for compliance with \"no fixed components\" rule */}\n    </DocumentTemplate>\n  );\n}\n\nexport default function PODetailPage() {\n  return (\n    <Suspense fallback={<DetailSkeleton />}>\n      <PODetailContent />\n    </Suspense>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\po\\create\\page.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'SmallText' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"SmallText"},"fix":{"range":[335,348],"text":""},"desc":"Remove unused variable 'SmallText'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SmallText' is defined but never used.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[660,721],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'formatIndianCurrency' is defined but never used.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatIndianCurrency"},"fix":{"range":[965,986],"text":""},"desc":"Remove unused variable 'formatIndianCurrency'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatIndianCurrency' is defined but never used.","line":27,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'formatDate' is defined but never used.","line":27,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatDate"},"fix":{"range":[985,997],"text":""},"desc":"Remove unused variable 'formatDate'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is defined but never used.","line":27,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":42},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":130,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":130,"endColumn":20,"suggestions":[{"fix":{"range":[3836,3870],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":176,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":176,"endColumn":82},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":207,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":207,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":216,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":216,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":220,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":220,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":224,"column":45,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":224,"endColumn":94},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":231,"column":27,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":231,"endColumn":152},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":236,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":236,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":242,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":242,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":251,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":251,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":259,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":259,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":263,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":263,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":271,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":271,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":275,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":275,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":281,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":281,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":285,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":285,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":301,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":301,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":307,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":307,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":311,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":311,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":317,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":317,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":321,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":321,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":336,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":336,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":342,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":342,"endColumn":95},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":346,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":346,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":352,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":352,"endColumn":95},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":356,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":356,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":371,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":371,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":381,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":381,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":387,"column":25,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":387,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":391,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":391,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":410,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":410,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":420,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":420,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":440,"column":17,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":440,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":455,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":455,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":460,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":460,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":465,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":465,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":470,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":470,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":475,"column":30,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":475,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":490,"column":39,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":490,"endColumn":127},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":501,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":501,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":505,"column":38,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":505,"endColumn":102},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":512,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":512,"endColumn":97},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":516,"column":38,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":516,"endColumn":102},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":523,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":523,"endColumn":97},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":556,"column":39,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":556,"endColumn":115},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":565,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":565,"endColumn":121},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":576,"column":36,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":576,"endColumn":116},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":577,"column":33,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":577,"endColumn":85},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":590,"column":26,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":590,"endColumn":114},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":595,"column":21,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":595,"endColumn":88}],"suppressedMessages":[],"errorCount":53,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { Save, Plus, Trash2, Package, Loader2, FileText, Calendar } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  H3,\n  Label,\n  SmallText,\n  Body,\n  Accounting,\n} from \"@/components/design-system/organisms\";\nimport { DocumentJourney } from \"@/components/design-system/molecules/DocumentJourney\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport { Button } from \"@/components/design-system/organisms\";\nimport { Badge } from \"@/components/design-system/organisms\";\nimport { Input } from \"@/components/design-system/organisms\";\nimport { Card } from \"@/components/design-system/organisms\";\nimport {\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  TabsContent,\n} from \"@/components/design-system/molecules/Tabs\";\nimport { formatIndianCurrency, formatDate } from \"@/lib/utils\";\nimport { api } from \"@/lib/api\";\n\nfunction CreatePOPageContent() {\n  const router = useRouter();\n\n  const initialData = {\n    header: {\n      po_number: \"\",\n      po_date: new Date().toISOString().split(\"T\")[0],\n      supplier_name: \"\",\n      supplier_code: \"\",\n      supplier_phone: \"\",\n      supplier_fax: \"\",\n      supplier_email: \"\",\n      department_no: \"\",\n      enquiry_no: \"\",\n      enquiry_date: \"\",\n      quotation_ref: \"\",\n      quotation_date: \"\",\n      rc_no: \"\",\n      order_type: \"\",\n      po_status: \"New\",\n      amend_no: 0,\n      po_value: 0,\n      fob_value: 0,\n      net_po_value: 0,\n      tin_no: \"\",\n      ecc_no: \"\",\n      mpct_no: \"\",\n      inspection_by: \"\",\n      inspection_at: \"BHEL Works, Bhopal\",\n      consignee_name: \"BHEL BHOPAL\",\n      consignee_address: \"PIPLANI, BHOPAL, MADHYA PRADESH, 462022\",\n      issuer_name: \"\",\n      issuer_designation: \"\",\n      issuer_phone: \"\",\n      remarks: \"\",\n    },\n    items: [],\n  };\n\n  const [data, setData] = useState<any>(initialData);\n  const [activeTab, setActiveTab] = useState(\"basic\");\n  const [saving, setSaving] = useState(false);\n\n  const addItem = useCallback(() => {\n    setData((prev: any) => {\n      const maxItemNo =\n        prev.items.length > 0 ? Math.max(...prev.items.map((i: any) => i.po_item_no || 0)) : 0;\n      const newItem = {\n        po_item_no: maxItemNo + 1,\n        material_code: \"\",\n        material_description: \"\",\n        drg_no: \"\",\n        unit: \"NOS\",\n        ord_qty: 0,\n        po_rate: 0,\n        item_value: 0,\n        deliveries: [],\n      };\n      return { ...prev, items: [...prev.items, newItem] };\n    });\n  }, []);\n\n  const removeItem = useCallback((itemNo: number) => {\n    setData((prev: any) => ({\n      ...prev,\n      items: prev.items.filter((i: any) => i.po_item_no !== itemNo),\n    }));\n  }, []);\n\n  const handleSave = useCallback(async () => {\n    if (!data.header.po_number) {\n      alert(\"PO Number is required\");\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // Map frontend data to backend PODetail schema\n      const payload = {\n        header: {\n          ...data.header,\n          po_number: parseInt(data.header.po_number),\n          po_date: data.header.po_date,\n        },\n        items: data.items.map((item: any) => ({\n          po_item_no: item.po_item_no,\n          material_code: item.material_code,\n          material_description: item.material_description,\n          drg_no: item.drg_no,\n          unit: item.unit,\n          po_rate: item.po_rate,\n          ordered_quantity: item.ord_qty,\n          item_value: item.item_value,\n          deliveries: [], // Simple manual PO creation defaults to one delivery in backend\n        })),\n      };\n\n      await api.createPO(payload);\n      router.push(`/po/${data.header.po_number}`);\n    } catch (err: any) {\n      console.error(\"Save Error:\", err);\n      alert(err.message || \"Failed to save Purchase Order\");\n    } finally {\n      setSaving(false);\n    }\n  }, [data, router]);\n\n  const { header, items } = data;\n\n  const updateHeader = useCallback((field: string, value: any) => {\n    setData({\n      ...data,\n      header: { ...data.header, [field]: value },\n    });\n  }, [data]);\n\n  const updateItem = (index: number, field: string, value: any) => {\n    const newItems = [...data.items];\n    newItems[index] = { ...newItems[index], [field]: value };\n    if (field === \"ord_qty\" || field === \"po_rate\") {\n      newItems[index].item_value = (newItems[index].ord_qty || 0) * (newItems[index].po_rate || 0);\n    }\n    setData({ ...data, items: newItems });\n  };\n\n  const topActions = (\n    <div className=\"flex items-center gap-2\">\n      <Button variant=\"outline\" size=\"sm\" onClick={() => router.back()} disabled={saving}>\n        Cancel\n      </Button>\n      <Button variant=\"default\" size=\"sm\" onClick={handleSave} disabled={saving}>\n        {saving ? (\n          <Loader2 size={16} className=\"animate-spin mr-2\" />\n        ) : (\n          <Save size={16} className=\"mr-2\" />\n        )}\n        {saving ? \"Saving...\" : \"Save PO\"}\n      </Button>\n    </div>\n  );\n\n  return (\n    <DocumentTemplate\n      title=\"Create Purchase Order\"\n      description=\"Enter procurement contract details manually\"\n      actions={topActions}\n      icon={<FileText size={20} className=\"text-[var(--color-sys-brand-primary)]\" />}\n      iconLayoutId=\"create-po-icon\"\n    >\n      <div className=\"mb-6\">\n        <DocumentJourney currentStage=\"PO\" />\n      </div>\n\n      <div className=\"space-y-6\">\n        {/* Tabs for Header Info */}\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"mb-4 bg-[var(--color-sys-bg-tertiary)]/30 p-1 rounded-xl\">\n            <TabsTrigger value=\"basic\">Basic Info</TabsTrigger>\n            <TabsTrigger value=\"supplier\">Supplier</TabsTrigger>\n            <TabsTrigger value=\"references\">References</TabsTrigger>\n            <TabsTrigger value=\"financial\">Financial</TabsTrigger>\n            <TabsTrigger value=\"issuer\">Issuer</TabsTrigger>\n            <TabsTrigger value=\"consignee\">Consignee</TabsTrigger>\n          </TabsList>\n\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={activeTab}\n              initial={{ opacity: 0, y: 4 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -4 }}\n              transition={{ duration: 0.15, ease: \"easeOut\" }}\n            >\n              <Card className=\"p-6\">\n                <TabsContent value=\"basic\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        PO Number\n                      </Label>\n                      <Input\n                        id=\"po-number\"\n                        name=\"po-number\"\n                        value={header.po_number}\n                        onChange={(e) => updateHeader(\"po_number\", e.target.value)}\n                        placeholder=\"e.g. 4500012345\"\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        PO Date\n                      </Label>\n                      <div className=\"bg-white/40 backdrop-blur-md px-3 py-1.5 rounded-xl border border-white/50 shadow-sm focus-within:ring-2 focus-within:ring-[var(--color-sys-brand-primary)]/10 transition-all flex items-center gap-2\">\n                        <Calendar size={14} className=\"text-[var(--color-sys-brand-primary)]\" />\n                        <Input\n                          id=\"po-date\"\n                          name=\"po-date\"\n                          type=\"date\"\n                          value={header.po_date}\n                          onChange={(e) => updateHeader(\"po_date\", e.target.value)}\n                          className=\"font-bold text-[var(--color-sys-text-primary)] bg-transparent border-none p-0 focus:ring-0 cursor-pointer text-sm\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Department No\n                      </Label>\n                      <Input\n                        value={header.department_no}\n                        onChange={(e) => updateHeader(\"department_no\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"supplier\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Supplier Name\n                      </Label>\n                      <Input\n                        id=\"supplier-name\"\n                        name=\"supplier-name\"\n                        value={header.supplier_name}\n                        onChange={(e) => updateHeader(\"supplier_name\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Supplier Code\n                      </Label>\n                      <Input\n                        id=\"supplier-code\"\n                        name=\"supplier-code\"\n                        value={header.supplier_code}\n                        onChange={(e) => updateHeader(\"supplier_code\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Phone\n                      </Label>\n                      <Input\n                        value={header.supplier_phone}\n                        onChange={(e) => updateHeader(\"supplier_phone\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Email\n                      </Label>\n                      <Input\n                        type=\"email\"\n                        value={header.supplier_email}\n                        onChange={(e) => updateHeader(\"supplier_email\", e.target.value)}\n                        className=\"font-medium text-slate-930\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"references\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Enquiry No\n                      </Label>\n                      <Input\n                        value={header.enquiry_no}\n                        onChange={(e) => updateHeader(\"enquiry_no\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        RC Number\n                      </Label>\n                      <Input\n                        value={header.rc_no}\n                        onChange={(e) => updateHeader(\"rc_no\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Order Type\n                      </Label>\n                      <Input\n                        value={header.order_type}\n                        onChange={(e) => updateHeader(\"order_type\", e.target.value)}\n                        className=\"font-medium text-slate-930\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"financial\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        TIN Number\n                      </Label>\n                      <Input\n                        value={header.tin_no}\n                        onChange={(e) => updateHeader(\"tin_no\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)] font-mono\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        ECC Number\n                      </Label>\n                      <Input\n                        value={header.ecc_no}\n                        onChange={(e) => updateHeader(\"ecc_no\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)] font-mono\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        MPCT Number\n                      </Label>\n                      <Input\n                        value={header.mpct_no}\n                        onChange={(e) => updateHeader(\"mpct_no\", e.target.value)}\n                        className=\"font-medium text-slate-930 font-mono\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"issuer\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Issuer Name\n                      </Label>\n                      <Input\n                        value={header.issuer_name}\n                        onChange={(e) => updateHeader(\"issuer_name\", e.target.value)}\n                        className=\"font-medium text-slate-930\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Designation\n                      </Label>\n                      <Input\n                        value={header.issuer_designation}\n                        onChange={(e) => updateHeader(\"issuer_designation\", e.target.value)}\n                        className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                      />\n                    </div>\n                    <div className=\"col-span-full space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Remarks\n                      </Label>\n                      <textarea\n                        id=\"remarks\"\n                        name=\"remarks\"\n                        value={header.remarks}\n                        onChange={(e) => updateHeader(\"remarks\", e.target.value)}\n                        className=\"w-full px-3 py-2 text-slate-930 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-950/10 focus:border-slate-300 resize-none transition-all\"\n                        rows={3}\n                        placeholder=\"Additional project information...\"\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"consignee\" className=\"mt-0\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Consignee Name\n                      </Label>\n                      <Input\n                        value={header.consignee_name}\n                        onChange={(e) => updateHeader(\"consignee_name\", e.target.value)}\n                        className=\"font-medium text-slate-930\"\n                      />\n                    </div>\n                    <div className=\"space-y-1.5\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-secondary)]\">\n                        Consignee Address\n                      </Label>\n                      <textarea\n                        value={header.consignee_address}\n                        onChange={(e) => updateHeader(\"consignee_address\", e.target.value)}\n                        className=\"w-full px-3 py-2 text-slate-930 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-slate-950/10 focus:border-slate-300 resize-none transition-all\"\n                        rows={3}\n                      />\n                    </div>\n                  </div>\n                </TabsContent>\n              </Card>\n            </motion.div>\n          </AnimatePresence>\n        </Tabs>\n\n        {/* Items Section */}\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center justify-between px-1\">\n            <H3 className=\"font-medium text-[var(--color-sys-text-primary)] text-sm\">\n              Material Items ({items.length})\n            </H3>\n            <Button color=\"secondary\" size=\"sm\" onClick={addItem}>\n              <Plus size={16} className=\"mr-2\" />\n              Add Item\n            </Button>\n          </div>\n\n          <Card className=\"p-0 overflow-hidden border-none shadow-sm\">\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b border-[var(--color-sys-text-tertiary)]/10 bg-[var(--color-sys-bg-tertiary)]/30\">\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-tertiary)]\">\n                        #\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-left\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-tertiary)]\">\n                        Material Details\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-tertiary)]\">\n                        Qty\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-tertiary)]\">\n                        Rate\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 text-right\">\n                      <Label className=\"uppercase text-[var(--color-sys-text-tertiary)]\">\n                        Value\n                      </Label>\n                    </th>\n                    <th className=\"py-3 px-6 w-16\"></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {items.length > 0 ? (\n                    items.map((item: any, idx: number) => (\n                      <tr\n                        key={`item-${idx}`}\n                        className=\"border-b border-[var(--color-sys-text-tertiary)]/5 hover:bg-[var(--color-sys-bg-tertiary)]/5 transition-colors\"\n                      >\n                        <td className=\"py-4 px-6\">\n                          <Accounting className=\"font-medium text-[var(--color-sys-text-primary)] font-mono text-center block\">\n                            {item.po_item_no}\n                          </Accounting>\n                        </td>\n                        <td className=\"py-4 px-6 space-y-3 min-w-[300px]\">\n                          <Input\n                            value={item.material_description}\n                            onChange={(e) =>\n                              updateItem(idx, \"material_description\", e.target.value)\n                            }\n                            placeholder=\"Material Description\"\n                            className=\"font-medium text-[var(--color-sys-text-primary)]\"\n                          />\n                          <div className=\"grid grid-cols-3 gap-2\">\n                            <div>\n                              <Label className=\"uppercase text-[var(--color-sys-text-tertiary)] ml-1\">\n                                Code\n                              </Label>\n                              <Input\n                                value={item.material_code}\n                                onChange={(e) => updateItem(idx, \"material_code\", e.target.value)}\n                                placeholder=\"Code\"\n                                className=\"font-medium text-[var(--color-sys-text-primary)] h-8\"\n                              />\n                            </div>\n                            <div>\n                              <Label className=\"uppercase text-[var(--color-sys-text-tertiary)] ml-1\">\n                                Drawing\n                              </Label>\n                              <Input\n                                value={item.drg_no}\n                                onChange={(e) => updateItem(idx, \"drg_no\", e.target.value)}\n                                placeholder=\"DRG\"\n                                className=\"font-medium text-[var(--color-sys-text-primary)] h-8\"\n                              />\n                            </div>\n                            <div>\n                              <Label className=\"uppercase text-slate-400 ml-1\">\n                                Unit\n                              </Label>\n                              <Input\n                                value={item.unit}\n                                onChange={(e) => updateItem(idx, \"unit\", e.target.value)}\n                                placeholder=\"Unit\"\n                                className=\"font-medium text-slate-930 h-8 uppercase\"\n                              />\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"py-4 px-6\">\n                          <Input\n                            type=\"number\"\n                            value={item.ord_qty}\n                            onChange={(e) => updateItem(idx, \"ord_qty\", parseFloat(e.target.value))}\n                            className=\"text-right font-mono\"\n                          />\n                        </td>\n                        <td className=\"py-4 px-6\">\n                          <Input\n                            type=\"number\"\n                            value={item.po_rate}\n                            onChange={(e) => updateItem(idx, \"po_rate\", parseFloat(e.target.value))}\n                            className=\"text-right font-mono\"\n                          />\n                        </td>\n                        <td className=\"py-4 px-6 text-right\">\n                          <Accounting className=\"font-medium text-[var(--color-sys-text-primary)] font-mono block\">\n                            {item.item_value}\n                          </Accounting>\n                        </td>\n                        <td className=\"py-4 px-6 text-center\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => removeItem(item.po_item_no)}\n                            className=\"text-[var(--color-sys-text-tertiary)] hover:text-[var(--color-sys-status-error)]\"\n                          >\n                            <Trash2 size={16} />\n                          </Button>\n                        </td>\n                      </tr>\n                    ))\n                  ) : (\n                    <tr>\n                      <td colSpan={6} className=\"py-24 text-center\">\n                        <div className=\"flex flex-col items-center justify-center opacity-40\">\n                          <Package className=\"w-12 h-12 text-[var(--color-sys-text-tertiary)]/30 mb-3 stroke-[1.5]\" />\n                          <Body className=\"text-[var(--color-sys-text-tertiary)]/60\">\n                            No material items defined yet\n                          </Body>\n                        </div>\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </table>\n            </div>\n            {items.length > 0 && (\n              <div className=\"bg-[var(--color-sys-bg-tertiary)]/30 border-t border-[var(--color-sys-text-tertiary)]/10 p-8 flex justify-end\">\n                <div className=\"text-right flex items-center gap-8\">\n                  <Label className=\"text-small uppercase tracking-[0.2em] text-[var(--color-sys-text-secondary)]\">\n                    Estimated Total Value\n                  </Label>\n                  <Accounting\n                    isCurrency\n                    className=\"text-2xl text-[var(--color-sys-text-primary)] font-mono\"\n                  >\n                    {items.reduce((acc: number, cur: any) => acc + (cur.item_value || 0), 0)}\n                  </Accounting>\n                </div>\n              </div>\n            )}\n          </Card>\n        </div>\n      </div>\n    </DocumentTemplate>\n  );\n}\n\nexport default function CreatePOPage() {\n  return (\n    <ErrorBoundary>\n      <CreatePOPageContent />\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\po\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\po\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\reports\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\reports\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\settings\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\settings\\my-details\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\srv\\[id]\\page.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"ArrowLeft"},"fix":{"range":[169,179],"text":""},"desc":"Remove unused variable 'ArrowLeft'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ArrowLeft' is defined but never used.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[178,190],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[230,245],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"Activity"},"fix":{"range":[245,257],"text":""},"desc":"Remove unused variable 'Activity'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Activity' is defined but never used.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'H1' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":5,"suggestions":[{"messageId":"removeVar","data":{"varName":"H1"},"fix":{"range":[353,356],"text":""},"desc":"Remove unused variable 'H1'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'H1' is defined but never used.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":5},{"ruleId":"no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"Label"},"fix":{"range":[396,405],"text":""},"desc":"Remove unused variable 'Label'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Label' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":8},{"ruleId":"no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"Card"},"fix":{"range":[424,432],"text":""},"desc":"Remove unused variable 'Card'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":7},{"ruleId":"no-unused-vars","severity":1,"message":"'Grid' is defined but never used.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"Grid"},"fix":{"range":[456,464],"text":""},"desc":"Remove unused variable 'Grid'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Grid' is defined but never used.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":7},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":65,"column":19,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":65,"endColumn":80},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":68,"column":24,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":68,"endColumn":87},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":81,"column":19,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":81,"endColumn":92},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":84,"column":24,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":84,"endColumn":87},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":97,"column":15,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":97,"endColumn":108},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":105,"column":24,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":105,"endColumn":87},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":117,"column":19,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":117,"endColumn":92},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":120,"column":24,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":120,"endColumn":87},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":147,"column":23,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":147,"endColumn":89},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":158,"column":23,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":158,"endColumn":90},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":169,"column":23,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":169,"endColumn":88},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":184,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":184,"endColumn":22,"suggestions":[{"fix":{"range":[5253,5286],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":225,"column":32,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":225,"endColumn":81},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":261,"column":29,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":261,"endColumn":77},{"ruleId":"no-restricted-syntax","severity":2,"message":"VIOLATION: Use Typography atoms (H1, H2, Accounting) instead of manual font classes.","line":280,"column":17,"nodeType":"JSXAttribute","messageId":"restrictedSyntax","endLine":280,"endColumn":93}],"suppressedMessages":[],"errorCount":22,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useState, useMemo } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport { api } from \"@/lib/api\";\nimport {\n  ArrowLeft,\n  Calendar,\n  FileText,\n  Package,\n  AlertTriangle,\n  CheckCircle,\n  Activity,\n  ClipboardCheck,\n} from \"lucide-react\";\nimport { formatDate } from \"@/lib/utils\";\nimport {\n  H1,\n  H3,\n  SmallText,\n  Body,\n  Accounting,\n  Label,\n  Button,\n  Badge,\n  Card,\n  Flex,\n  Stack,\n  Box,\n  Grid,\n  type Column,\n  DataTable,\n  SummaryCards,\n} from \"@/components/design-system/organisms\";\nimport { DocumentTemplate } from \"@/components/design-system/templates/DocumentTemplate\";\nimport dynamic from \"next/dynamic\";\n\nconst DocumentJourney = dynamic(\n  () =>\n    import(\"@/components/design-system/molecules/DocumentJourney\").then(\n      (mod) => mod.DocumentJourney\n    ),\n  {\n    ssr: false,\n    loading: () => <div className=\"h-6 w-48 bg-slate-100 rounded-full animate-pulse\" />,\n  }\n);\n\nexport default function SRVDetailPage() {\n  const params = useParams();\n  const router = useRouter();\n  const [srv, setSrv] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  // Columns definition moved to top to prevent Hook order violation\n  const itemColumns = useMemo<Column<any>[]>(\n    () => [\n      { key: \"div_code\", label: \"DIV\", align: \"center\", width: \"5%\" },\n      {\n        key: \"po_item_no\",\n        label: \"Item\",\n        width: \"10%\",\n        render: (_v: any, row: any) => (\n          <Stack align=\"center\">\n            <Body className=\"text-[var(--color-sys-text-primary)] leading-none\">\n              ITEM-{row.po_item_no}\n            </Body>\n            <SmallText className=\"text-[var(--color-sys-text-secondary)] leading-none\">\n              Lot {row.lot_no}\n            </SmallText>\n          </Stack>\n        ),\n      },\n      { key: \"pmir_no\", label: \"PMIR\", width: \"8%\" },\n      {\n        key: \"challan_no\",\n        label: \"Challan\",\n        width: \"12%\",\n        render: (_v: any, row: any) => (\n          <Stack>\n            <Body className=\"font-medium text-[var(--color-sys-text-primary)] leading-none\">\n              {row.challan_no || \"-\"}\n            </Body>\n            <SmallText className=\"text-[var(--color-sys-text-secondary)] leading-none\">\n              {row.challan_date ? formatDate(row.challan_date) : \"-\"}\n            </SmallText>\n          </Stack>\n        ),\n      },\n      {\n        key: \"invoice_no\",\n        label: \"Invoice\",\n        width: \"12%\",\n        render: (_v: any, row: any) => (\n          <Stack>\n            <Body\n              className=\"text-[var(--color-sys-brand-primary)] cursor-pointer hover:underline leading-none\"\n              onClick={() =>\n                row.invoice_no &&\n                router.push(`/invoice/${encodeURIComponent(row.invoice_no.toString().trim())}`)\n              }\n            >\n              {row.invoice_no || \"-\"}\n            </Body>\n            <SmallText className=\"text-[var(--color-sys-text-secondary)] leading-none\">\n              {row.invoice_date ? formatDate(row.invoice_date) : \"-\"}\n            </SmallText>\n          </Stack>\n        ),\n      },\n      {\n        key: \"cnote_no\",\n        label: \"CNOTE\",\n        width: \"12%\",\n        render: (_v: any, row: any) => (\n          <Stack>\n            <Body className=\"font-medium text-[var(--color-sys-text-primary)] leading-none\">\n              {row.cnote_no || \"-\"}\n            </Body>\n            <SmallText className=\"text-[var(--color-sys-text-secondary)] leading-none\">\n              {row.cnote_date ? formatDate(row.cnote_date) : \"-\"}\n            </SmallText>\n          </Stack>\n        ),\n      },\n      { key: \"unit\", label: \"UNIT\", align: \"center\", width: \"6%\" },\n      {\n        key: \"order_qty\",\n        label: \"ORDERED\",\n        align: \"right\",\n        width: \"8%\",\n        render: (v: any) => <Accounting className=\"text-right block\">{v}</Accounting>,\n      },\n      {\n        key: \"challan_qty\",\n        label: \"CHALLAN\",\n        align: \"right\",\n        width: \"8%\",\n        render: (v: any) => <Accounting className=\"text-right block font-mono\">{v}</Accounting>,\n      },\n      {\n        key: \"received_qty\",\n        label: \"RECD\",\n        align: \"right\",\n        width: \"8%\",\n        render: (_v: any, row: any) => (\n          <Accounting className=\"text-[var(--color-sys-brand-primary)] text-right block\">\n            {row.received_qty}\n          </Accounting>\n        ),\n      },\n      {\n        key: \"accepted_qty\",\n        label: \"ACCEPTED\",\n        align: \"right\",\n        width: \"8%\",\n        render: (_v: any, row: any) => (\n          <Accounting className=\"text-[var(--color-sys-status-success)] text-right block\">\n            {row.accepted_qty}\n          </Accounting>\n        ),\n      },\n      {\n        key: \"rejected_qty\",\n        label: \"REJECTED\",\n        align: \"right\",\n        width: \"8%\",\n        render: (_v: any, row: any) => (\n          <Accounting className=\"text-[var(--color-sys-status-error)] text-right block\">\n            {row.rejected_qty}\n          </Accounting>\n        ),\n      },\n    ],\n    [router]\n  );\n\n  const loadSRV = useMemo(\n    () => async (id: string) => {\n      try {\n        const data = await api.getSRV(id);\n        setSrv(data);\n      } catch (err) {\n        console.error(\"SRV Error:\", err);\n      } finally {\n        setLoading(false);\n      }\n    },\n    []\n  );\n\n  useEffect(() => {\n    if (params.id) {\n      loadSRV(params.id as string);\n    }\n  }, [params.id, loadSRV]);\n\n  if (loading || !srv || !srv.header) {\n    return (\n      <DocumentTemplate\n        title={loading ? \"Synchronizing...\" : \"SRV Not Found\"}\n        description={\n          loading ? \"Retrieving record data from ledger\" : \"Traceback failure in record retrieval\"\n        }\n        onBack={() => router.push(\"/srv\")}\n      >\n        <Stack gap={6}>\n          <Box className=\"h-8 w-64 bg-slate-100 rounded-full animate-pulse\" />\n          <Box className=\"h-[200px] w-full bg-slate-50 rounded-xl border border-slate-100 animate-pulse\" />\n        </Stack>\n      </DocumentTemplate>\n    );\n  }\n\n  const { header, items = [] } = srv;\n\n  const totalReceived = items.reduce((acc: number, item: any) => acc + (item.received_qty || 0), 0);\n  const totalRejected = items.reduce((acc: number, item: any) => acc + (item.rejected_qty || 0), 0);\n\n  return (\n    <DocumentTemplate\n      title={`SRV-${header.srv_number}`}\n      description={`Certified ${formatDate(header.srv_date)} ΓÇó Contract: ${header.po_number}`}\n      onBack={() => router.back()}\n      icon={<Package size={20} className=\"text-[var(--color-sys-brand-primary)]\" />}\n      actions={\n        <Flex gap={3}>\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => window.print()}>\n            <FileText size={16} />\n            Export Report\n          </Button>\n        </Flex>\n      }\n    >\n      <Stack gap={6}>\n        <Flex align=\"center\" gap={3}>\n          <Badge variant=\"default\">INSPECTED</Badge>\n          <Badge\n            variant=\"outline\"\n            className=\"cursor-pointer hover:bg-[var(--color-sys-brand-primary)]/10 transition-colors\"\n            onClick={() => router.push(`/po/${header.po_number}`)}\n          >\n            Ref: {header.po_number}\n          </Badge>\n        </Flex>\n\n        <DocumentJourney currentStage=\"SRV\" className=\"mb-2\" />\n\n        {/* Summary Cards */}\n        <SummaryCards\n          cards={[\n            {\n              title: \"Receipt Volume\",\n              value: <Accounting>{totalReceived}</Accounting>,\n              icon: <Package size={20} />,\n              variant: \"primary\",\n            },\n            {\n              title: \"Quality Deficiency\",\n              value: (\n                <Accounting className=\"text-[var(--color-sys-status-error)]\">\n                  {totalRejected}\n                </Accounting>\n              ),\n              icon: <AlertTriangle size={20} />,\n              variant: \"error\",\n            },\n            {\n              title: \"Verification Node\",\n              value: items[0]?.invoice_no || \"PENDING AUDIT\",\n              icon: <ClipboardCheck size={20} />,\n              variant: \"secondary\",\n            },\n          ]}\n        />\n\n        {/* Items Table */}\n        <Stack gap={4}>\n          <Flex align=\"center\" justify=\"between\">\n            <H3 className=\"text-[var(--color-sys-text-secondary)] uppercase tracking-widest\">\n              Inspection Manifest\n            </H3>\n            <Badge variant=\"default\">\n              {items.length} Quality Nodes\n            </Badge>\n          </Flex>\n          <DataTable columns={itemColumns} data={items} keyField=\"id\" density=\"compact\" />\n        </Stack>\n      </Stack>\n    </DocumentTemplate>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\abhij\\.gemini\\antigravity\\scratch\\SenstoSales\\frontend\\app\\srv\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
